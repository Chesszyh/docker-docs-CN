---
title: Docker Engine 24.0 发布说明
linkTitle: Engine v24.0
description: 了解 Docker Engine 24.0 版的新功能、错误修复和重大变更
keywords: docker, docker engine, ce, whats new, release notes, 发布说明
toc_min: 1
toc_max: 2
---

本页描述了 Docker Engine 24.0 版的最新变更、新增内容、已知问题和修复。

有关以下内容的更多信息：

- 已弃用和已移除的功能，请参阅 [已弃用的 Engine 功能](../deprecated.md)。
- Engine API 的变更，请参阅 [Engine API 版本历史](/reference/api/engine/version-history.md)。

## 24.0.9

{{< release-date date="2024-01-31" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.9 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.9)
- [moby/moby, 24.0.9 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.9)

## 安全

此版本包含针对影响 Docker Engine 及其组件的以下 CVE 的安全修复。

| CVE                                                         | 组件          | 修复版本    | 严重性           |
| ----------------------------------------------------------- | ------------- | ----------- | ---------------- |
| [CVE-2024-21626](https://scout.docker.com/v/CVE-2024-21626) | runc          | 1.1.12      | 高, CVSS 8.6   |
| [CVE-2024-24557](https://scout.docker.com/v/CVE-2024-24557) | Docker Engine | 24.0.9      | 中, CVSS 6.9 |

> [!IMPORTANT]
>
> 请注意，此版本的 Docker Engine 不包含对 BuildKit 中以下已知漏洞的修复：
>
> - [CVE-2024-23651](https://scout.docker.com/v/CVE-2024-23651)
> - [CVE-2024-23652](https://scout.docker.com/v/CVE-2024-23652)
> - [CVE-2024-23653](https://scout.docker.com/v/CVE-2024-23653)
> - [CVE-2024-23650](https://scout.docker.com/v/CVE-2024-23650)
>
> 要解决这些漏洞，请升级至 [Docker Engine v25.0.2](./25.0.md#2502)。

有关此版本中解决的安全问题以及 BuildKit 中未解决漏洞的更多信息，请参阅 [博客文章](https://www.docker.com/blog/docker-security-advisory-multiple-vulnerabilities-in-runc-buildkit-and-moby/)。

有关各漏洞的详情，请参阅相关的安全公告：

- [CVE-2024-21626](https://github.com/opencontainers/runc/security/advisories/GHSA-xr7r-f8xq-vfvv)
- [CVE-2024-24557](https://github.com/moby/moby/security/advisories/GHSA-xw73-rw38-6vjc)

### 打包更新

- 将 runc 更新至 [v1.1.12](https://github.com/opencontainers/runc/releases/tag/v1.1.12)。[moby/moby#47269](https://github.com/moby/moby/pull/47269)
- 将 containerd 更新至 [v1.7.13](https://github.com/containerd/containerd/releases/tag/v1.7.13) (仅限静态二进制文件)。[moby/moby#47280](https://github.com/moby/moby/pull/47280)

## 24.0.8

{{< release-date date="2024-01-25" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.8 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.8)
- [moby/moby, 24.0.8 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.8)

### 错误修复与改进
* 实时恢复 (Live restore)：带有自动移除 (`docker run --rm`) 的容器在 Engine 重启时不再被强制移除。[moby/moby#46857](https://github.com/moby/moby/pull/46869)

### 打包更新
* 将 Go 更新至 `go1.20.13`。[moby/moby#47054](https://github.com/moby/moby/pull/47054), [docker/cli#4826](https://github.com/docker/cli/pull/4826), [docker/docker-ce-packaging#975](https://github.com/docker/docker-ce-packaging/pull/975)
* 将 containerd (仅限静态二进制文件) 更新至 [v1.7.12](https://github.com/containerd/containerd/releases/tag/v1.7.12) [moby/moby#47096](https://github.com/moby/moby/pull/47096)
* 将 runc 更新至 v1.1.11。[moby/moby#47010](https://github.com/moby/moby/pull/47010)

## 24.0.7

{{< release-date date="2023-10-27" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.7 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.7)
- [moby/moby, 24.0.7 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.7)

### 错误修复与改进

* 以原子方式写入 overlay2 层元数据。[moby/moby#46703](https://github.com/moby/moby/pull/46703)
* 修复了 systemd 250 及更高版本上的 "Rootful-in-Rootless" Docker-in-Docker。[moby/moby#46626](https://github.com/moby/moby/pull/46626)
* 修复了用户名包含反斜杠时的 `dockerd-rootless-setuptools.sh`。[moby/moby#46407](https://github.com/moby/moby/pull/46407)
* 修复了一个 bug，该 bug 导致在停止没有网络连接的容器且使用 `dockerd --bridge=none` 时，无法完全删除网络沙箱。[moby/moby#46702](https://github.com/moby/moby/pull/46702)
* 修复了一个 bug，即取消 API 请求可能会中断容器重启。[moby/moby#46697](https://github.com/moby/moby/pull/46697)
* 修复了一个问题，即当提供的 `--ip-range` 范围大于子网时，容器无法启动。[docker/for-mac#6870](https://github.com/docker/for-mac/issues/6870)
* 修复了 zstd 输出的数据损坏问题。[moby/moby#46709](https://github.com/moby/moby/pull/46709)
* 修复了应用容器 MAC 地址的条件。[moby/moby#46478](https://github.com/moby/moby/pull/46478)
* 改进了统计收集器的性能。[moby/moby#46448](https://github.com/moby/moby/pull/46448)
* 修复了源策略规则顺序错误的问题。[moby/moby#46441](https://github.com/moby/moby/pull/46441)

### 打包更新

* 增加了对 Fedora 39 和 Ubuntu 23.10 的支持。[docker/docker-ce-packaging#940](https://github.com/docker/docker-ce-packaging/pull/940), [docker/docker-ce-packaging#955](https://github.com/docker/docker-ce-packaging/pull/955)
* 修复了卸载 `docker-ce` RPM 包时 `docker.socket` 未被禁用的问题。[docker/docker-ce-packaging#852](https://github.com/docker/docker-ce-packaging/pull/852)
* 将 Go 更新至 `go1.20.10`。[docker/docker-ce-packaging#951](https://github.com/docker/docker-ce-packaging/pull/951)
* 将 containerd 更新至 `v1.7.6` (仅限静态二进制文件)。[moby/moby#46103](https://github.com/moby/moby/pull/46103)
* 将 `containerd.io` 软件包更新至 [`v1.6.24`](https://github.com/containerd/containerd/releases/tag/v1.6.24)。

### 安全

* 默认禁止容器访问 `/sys/devices/virtual/powercap`。此更改加强了对 [CVE-2020-8694](https://scout.docker.com/v/CVE-2020-8694)、[CVE-2020-8695](https://scout.docker.com/v/CVE-2020-8695) 和 [CVE-2020-12912](https://scout.docker.com/v/CVE-2020-12912) 以及被称为 [PLATYPUS 攻击](https://platypusattack.com/) 的防御。

  更多详情请参阅 [公告](https://github.com/moby/moby/security/advisories/GHSA-jq35-85cj-fj4p) 和 [提交](https://github.com/moby/moby/commit/c9ccbfad11a60e703e91b6cca4f48927828c7e35)。

## 24.0.6

{{< release-date date="2023-09-05" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.6 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.6)
- [moby/moby, 24.0.6 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.6)

### 错误修复与改进

* containerd 存储后端：修复了当内容存储中不再存在容器镜像时 `docker ps` 失败的问题。[moby/moby#46095](https://github.com/moby/moby/pull/46095)
* containerd 存储后端：修复了当内容存储中不再存在容器镜像配置时 `docker ps -s -a` 和 `docker container prune` 失败的问题。[moby/moby#46097](https://github.com/moby/moby/pull/46097)
* containerd 存储后端：修复了当内容存储中不再存在 (或从未存在) 容器镜像配置时 `docker inspect` 失败的问题。[moby/moby#46244](https://github.com/moby/moby/pull/46244)
* containerd 存储后端：通过使用引用计数的 rootfs 挂载，修复了 `overlayfs` 快照器的差异 (diff) 和导出 (export) 问题。[moby/moby#46266](https://github.com/moby/moby/pull/46266)
* containerd 存储后端：修复了当本地可用的镜像平台与所需平台不匹配时令人误解的错误提示。[moby/moby#46300](https://github.com/moby/moby/pull/46300)
* containerd 存储后端：修复了使用经典构建器时的 `FROM scratch` Dockerfile 指令。[moby/moby#46302](https://github.com/moby/moby/pull/46302)
* containerd 存储后端：修复了使用经典构建器时出现的 `mismatched image rootfs and manifest layers` 错误。[moby/moby#46310](https://github.com/moby/moby/pull/46310)
* 在从所有注册表拉取 Docker 镜像格式 v1 以及 Docker 镜像清单版本 2, schema 1 镜像时发出警告。[moby/moby#46290](https://github.com/moby/moby/pull/46290)
* 修复了具有自定义卷选项的卷的实时恢复 (live-restore)。[moby/moby#46366](https://github.com/moby/moby/pull/46366)
* 修复了以非 root 用户运行容器时错误丢弃能力位的问题 (注意：由于回归，此更改已实际存在)。[moby/moby#46221](https://github.com/moby/moby/pull/46221)
* 修复了网络隔离 iptables 规则阻止容器之间交换 IPv6 邻居请求 (Neighbor Solicitation) 数据包的问题。[moby/moby#46214](https://github.com/moby/moby/pull/46214)
* 修复了在 Windows 上当二进制文件位于当前目录时 `dockerd.exe --register-service` 不起作用的问题。[moby/moby#46215](https://github.com/moby/moby/pull/46215)
* 在对 Docker Hub 进行 `docker login` 时添加了建议使用 PAT 的提示。[docker/cli#4500](https://github.com/docker/cli/pull/4500)
* 改进了 CLI 的 Bash 补全用户的 shell 启动时间。[docker/cli#4517](https://github.com/docker/cli/pull/4517)
* 通过尽可能跳过 `GET /_ping` 来提高某些命令的速度。[docker/cli#4508](https://github.com/docker/cli/pull/4508)
* 修复了对 Docker Hub 上的镜像进行 `docker manifest inspect` 时使用 PAT 的凭据作用域。[docker/cli#4512](https://github.com/docker/cli/pull/4512)
* 修复了 `docker events` 不支持 `--format=json` 的问题。[docker/cli#4544](https://github.com/docker/cli/pull/4544)

### 打包更新

* 将 Go 更新至 `go1.20.7`。[moby/moby#46140](https://github.com/moby/moby/pull/46140), [docker/cli#4476](https://github.com/docker/cli/pull/4476), [docker/docker-ce-packaging#932](https://github.com/docker/docker-ce-packaging/pull/932)
* 将 containerd 更新至 `v1.7.3` (仅限静态二进制文件)。[moby/moby#46103](https://github.com/moby/moby/pull/46103)
* 将 Compose 更新至 `v2.21.0`。[docker/docker-ce-packaging#936](https://github.com/docker/docker-ce-packaging/pull/936)

## 24.0.5

{{< release-date date="2023-07-24" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.5 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.5)
- [moby/moby, 24.0.5 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.5)

### 错误修复与改进

* Go 客户端现在避免在 HTTP `Host:` 标头中使用 UNIX 套接字路径，以兼容 `go1.20.6` 中引入的更改。[moby/moby#45962](https://github.com/moby/moby/pull/45962), [moby/moby#45990](https://github.com/moby/moby/pull/45990)
* containerd 存储后端：修复了 `docker image inspect` 和 `GET /images/{name}/json` 中未包含 `Variant` 的问题。[moby/moby#46025](https://github.com/moby/moby/pull/46025)
* containerd 存储后端：防止镜像导出期间内容可能被垃圾回收的情况。[moby/moby#46021](https://github.com/moby/moby/pull/46021)
* containerd 存储后端：防止 `RepoDigests` 中出现重复的摘要条目。[moby/moby#46014](https://github.com/moby/moby/pull/46014)
* containerd 存储后端：修复了在使用通过标签和摘要引用的镜像时，操作针对错误标签进行的问题。[moby/moby#46013](https://github.com/moby/moby/pull/46013)
* containerd 存储后端：修复了使用旧版构建器构建容器时由 `EXPOSE` 引起的崩溃 (panic)。[moby/moby#45921](https://github.com/moby/moby/pull/45921)
* 修复了一个回归问题，该问题导致尝试在非 Swarm 节点上创建 `overlay` 网络时返回不直观的错误。[moby/moby#45974](https://github.com/moby/moby/pull/45974)
* 正确报告从命令行解析卷规范时的错误。[docker/cli#4423](https://github.com/docker/cli/pull/4423)
* 修复了在 CLI 配置文件中发现 `auths: null` 时发生的崩溃 (panic)。[docker/cli#4450](https://github.com/docker/cli/pull/4450)

### 打包更新

* 使用 moby/moby `contrib/init` 中提供的 init 脚本。[docker/docker-ce-packaging#914](https://github.com/docker/docker-ce-packaging/pull/914), [docker/docker-ce-packaging#926](https://github.com/docker/docker-ce-packaging/pull/926)
* 从 `contrib/init` 中移除 Upstart。[moby/moby#46044](https://github.com/moby/moby/pull/46044)
* 将 Go 更新至 `go1.20.6`。[docker/cli#4428](https://github.com/docker/cli/pull/4428), [moby/moby#45970](https://github.com/moby/moby/pull/45970), [docker/docker-ce-packaging#921](https://github.com/docker/docker-ce-packaging/pull/921)
* 将 Compose 更新至 `v2.20.2`。[docker/docker-ce-packaging#924](https://github.com/docker/docker-ce-packaging/pull/924)
* 将 buildx 更新至 `v0.11.2`。[docker/docker-ce-packaging#922](https://github.com/docker/docker-ce-packaging/pull/922)


## 24.0.4

{{< release-date date="2023-07-07" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.4 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.4)
- [moby/moby, 24.0.4 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.4)

### 错误修复与改进

* 修复了 24.0.3 期间引入的一个回归问题，该问题导致在实时恢复 (live-restore) 带有绑定挂载的容器时发生崩溃 (panic)。[moby/moby#45903](https://github.com/moby/moby/pull/45903)


## 24.0.3

{{< release-date date="2023-07-06" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.3 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.3)
- [moby/moby, 24.0.3 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.3)

### 错误修复与改进

* containerd 镜像存储：修复了一个问题，即如果不包含默认平台的清单，则无法与多平台镜像进行交互。[moby/moby#45849](https://github.com/moby/moby/pull/45849)
* containerd 镜像存储：修复了在容器构建中试图缓存 `FROM scratch` 的不合理尝试。[moby/moby#45822](https://github.com/moby/moby/pull/45822)
* containerd 镜像存储：修复了使用无法多次挂载相同内容的快照器时的 `docker cp` 问题。[moby/moby#45780](https://github.com/moby/moby/pull/45780), [moby/moby#45786](https://github.com/moby/moby/pull/45786)
* containerd 镜像存储：修复了 `type=image` 的构建未被正确解压/存储的问题。[moby/moby#45692](https://github.com/moby/moby/pull/45692)
* containerd 镜像存储：修复了在 `docker load` 中错误地尝试解压伪镜像 (包括证明) 的问题。[moby/moby#45688](https://github.com/moby/moby/pull/45688)
* containerd 镜像存储：在与注册表交互时正确设置用户代理 (user agent)，并包含额外信息，如快照器等。[moby/moby#45671](https://github.com/moby/moby/pull/45671), [moby/moby#45684](https://github.com/moby/moby/pull/45684)
* containerd 镜像存储：修复了切换快照器后无法解压已拉取内容的问题。[moby/moby#45678](https://github.com/moby/moby/pull/45678)
* containerd 镜像存储：修复了被重新打标或移除所有标签的镜像在仍在使用时被清理的问题。[moby/moby#45857](https://github.com/moby/moby/pull/45857)
* 修复了一个 Swarm CSI 问题，即 Topology 字段未传播到 NodeCSIInfo 中。[moby/moby#45810](https://github.com/moby/moby/pull/45810)
* 修复了由于过大的 raft 日志导致添加新 Swarm 管理节点失败的问题。[moby/moby#45703](https://github.com/moby/moby/pull/45703), [moby/swarmkit#3122](https://github.com/moby/swarmkit/pull/3122), [moby/swarmkit#3128](https://github.com/moby/swarmkit/pull/3128)
* 默认 seccomp 配置文件现在始终允许 `name_to_handle_at(2)`。[moby/moby#45833](https://github.com/moby/moby/pull/45833)
* 修复了一个问题，该问题阻止加密的 Swarm overlay 网络在非默认端口 (4789) 上运行。[moby/moby#45637](https://github.com/moby/moby/pull/45637)
* 修复了在实时恢复 (live-restore) 期间无法恢复挂载引用计数的问题。[moby/moby#45824](https://github.com/moby/moby/pull/45824)
* 修复了实时恢复期间各种与网络相关的故障。[moby/moby#45658](https://github.com/moby/moby/pull/45658), [moby/moby#45659](https://github.com/moby/moby/pull/45659)
* 修复了当守护进程意外终止时，运行中的容器以零 (成功) 退出状态恢复的问题。[moby/moby#45801](https://github.com/moby/moby/pull/45801)
* 修复了执行健康检查探测时潜在的崩溃 (panic)。[moby/moby#45798](https://github.com/moby/moby/pull/45798)
* 修复了由容器 exec 启动中的竞态条件引起的崩溃 (panic)。[moby/moby#45794](https://github.com/moby/moby/pull/45794)
* 修复了将终端附加到包含不存在命令的 exec 时引起的异常。[moby/moby#45643](https://github.com/moby/moby/pull/45643)
* 通过将 IP 作为标签传递，修复了 BuildKit 的 `host-gateway` 问题 (也需要 [docker/buildx#1894](https://github.com/docker/buildx/pull/1894))。[moby/moby#45790](https://github.com/moby/moby/pull/45790)
* 修复了一个问题，即当请求被取消时，`POST /containers/{id}/stop` 会强制终止容器，而不是等待指定的超时时间进行“优雅”停止。[moby/moby#45774](https://github.com/moby/moby/pull/45774)
* 修复了一个问题，即从根目录 (`/`) 执行 `docker cp -a` 会失败。[moby/moby#45748](https://github.com/moby/moby/pull/45748)
* 通过在 OCI 配置中更正确地设置资源限制参数，提高了与非 runc 容器运行时的兼容性。[moby/moby#45746](https://github.com/moby/moby/pull/45746)
* 修复了在某些配置 (如 LDAP) 的无根模式下，由于 subuid/subgid 范围重叠引起的问题。[moby/moby#45747](https://github.com/moby/moby/pull/45747), [rootless-containers/rootlesskit#369](https://github.com/rootless-containers/rootlesskit/pull/369)
* 大大减少了在填充 `GET /info` 的调试部分时的 CPU 和内存使用量。[moby/moby#45856](https://github.com/moby/moby/pull/45856)
* 修复了一个问题，即当仅客户端处于调试模式时，`docker info` 期间无法正确打印调试信息。[docker/cli#4393](https://github.com/docker/cli/pull/4393)
* 修复了在通过 SSH 连接连接到主机时出现的连接挂起问题。[docker/cli#4395](https://github.com/docker/cli/pull/4395)

### 打包更新

* 将 Go 更新至 `go1.20.5`。[moby/moby#45745](https://github.com/moby/moby/pull/45745), [docker/cli#4351](https://github.com/docker/cli/pull/4351), [docker/docker-ce-packaging#904](https://github.com/docker/docker-ce-packaging/pull/904)
* 将 Compose 更新至 `v2.19.1`。[docker/docker-ce-packaging#916](https://github.com/docker/docker-ce-packaging/pull/916)
* 将 buildx 更新至 `v0.11.1`。[docker/docker-ce-packaging#918](https://github.com/docker/docker-ce-packaging/pull/918)


## 24.0.2

{{< release-date date="2023-05-26" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.2 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.2)
- [moby/moby, 24.0.2 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.2)

### 错误修复与改进

* 修复了构建期间引用本地打标镜像时的崩溃 (panic)。[moby/buildkit#3899](https://github.com/moby/buildkit/pull/3899), [moby/moby#45582](https://github.com/moby/moby/pull/45582)
* 修复了执行许多并发构建阶段时，构建可能因 `exit code: 4294967295` 失败的问题。[moby/moby#45620](https://github.com/moby/moby/pull/45620)
* 修复了 Windows 上的 DNS 解析忽略 `etc/hosts` (`%WINDIR%\System32\Drivers\etc\hosts`)，包括 `localhost` 解析的问题。[moby/moby#45562](https://github.com/moby/moby/pull/45562)
* 应用了针对 containerd 一个 bug 的变通方法，该 bug 导致并发的 `docker exec` 命令耗时明显长于预期。[moby/moby#45625](https://github.com/moby/moby/pull/45625)
* containerd 镜像存储：修复了镜像 `Created` 字段包含错误值的问题。[moby/moby#45623](https://github.com/moby/moby/pull/45623)
* containerd 镜像存储：调整了镜像拉取进度的输出，使得无论是否启用 containerd 镜像存储，输出格式均保持一致。[moby/moby#45602](https://github.com/moby/moby/pull/45602)
* containerd 镜像存储：现在在默认镜像存储与 containerd 镜像存储之间切换需要重启守护进程。[moby/moby#45616](https://github.com/moby/moby/pull/45616)

### 打包更新

* 将 Buildx 更新至 `v0.10.5`。[docker/docker-ce-packaging#900](https://github.com/docker/docker-ce-packaging/pull/900)


## 24.0.1

{{< release-date date="2023-05-19" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.1 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.1)
- [moby/moby, 24.0.1 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.1)

### 已移除

* 移除了 24.0 主版本中已移除存储驱动程序的 CLI 补全。[docker/cli#4302](https://github.com/docker/cli/pull/4302)

### 错误修复与改进

* 修复了一个问题，即来自外部服务器的 DNS 查询 NXDOMAIN 响应被作为 SERVFAIL 转发给客户端。[moby/moby#45573](https://github.com/moby/moby/pull/45573)
* 修复了一个问题，即 `docker pull --platform` 会针对指向同一镜像的另一个标签报告 `No such image`。[moby/moby#45562](https://github.com/moby/moby/pull/45562)
* 修复了一个问题，即配置重新加载期间会遗忘不安全注册表配置。[moby/moby#45571](https://github.com/moby/moby/pull/45571)
* containerd 镜像存储：修复了一个问题，即没有层的镜像不会被列在 `docker images -a` 中 [moby/moby#45588](https://github.com/moby/moby/pull/45588)
* API：修复了一个问题，即 `GET /images/{id}/json` 在 `RepoTags` 和 `RepoDigests` 为空时会返回 `null` 而不是空数组。[moby/moby#45564](https://github.com/moby/moby/pull/45564)
* API：修复了一个问题，即 `POST /commit` 不接受空请求体。[moby/moby#45568](https://github.com/moby/moby/pull/45568)

### 打包更新

* 将 Compose 更新至 `v2.18.1`。[docker/docker-ce-packaging#896](https://github.com/docker/docker-ce-packaging/pull/896)


## 24.0.0

{{< release-date date="2023-05-16" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 24.0.0 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A24.0.0)
- [moby/moby, 24.0.0 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A24.0.0)

### 新增功能

* 引入了对将 containerd 作为内容存储 (替换现有存储驱动程序) 的实验性支持。[moby/moby#43735](https://github.com/moby/moby/pull/43735), [其他 moby/moby PR](https://github.com/moby/moby/pulls?q=is%3Apr+is%3Amerged+milestone%3A24.0.0+-label%3Aprocess%2Fcherry-picked+label%3Acontainerd-integration+)
* `--host` CLI 标志现在在 `ssh://` 主机地址中支持路径组件，允许在远程主机上不进行配置的情况下使用备选套接字路径。[docker/cli#4073](https://github.com/docker/cli/pull/4073)
* `docker info` CLI 命令现在会报告版本和平台字段。[docker/cli#4180](https://github.com/docker/cli/pull/4180)
* 引入了守护进程标志 `--default-network-opt`，用于配置新创建网络的选项。[moby/moby#43197](https://github.com/moby/moby/pull/43197)
* 在默认 seccomp 配置文件中限制了对 `socket(2)` 系列系统调用中 `AF_VSOCK` 的访问。[moby/moby#44562](https://github.com/moby/moby/pull/44562)
* 引入了对在容器上设置 OCI 运行时注释 (annotations) 的支持。[docker/cli#4156](https://github.com/docker/cli/pull/4156), [moby/moby#45025](https://github.com/moby/moby/pull/45025)
* 现在可以在 `daemon.json` 中配置备选运行时，从而允许为运行时名称设置别名并传递选项。[moby/moby#45032](https://github.com/moby/moby/pull/45032)
* `docker-init` 二进制文件现在除了在 `PATH` 中外，还将在符合 FHS 标准的 libexec 目录中被发现。[moby/moby#45198](https://github.com/moby/moby/pull/45198)
* API：在 `GET /info` 中展示了守护进程级的 `--no-new-privileges` 标志。[moby/moby#45320](https://github.com/moby/moby/pull/45320)

### 已移除

* `docker info` 不再报告 `IndexServiceAddress`。[docker/cli#4204](https://github.com/docker/cli/pull/4204)
* libnetwork：移除了针对过时内核版本的回退代码。[moby/moby#44684](https://github.com/moby/moby/pull/44684), [moby/moby#44802](https://github.com/moby/moby/pull/44802)
* libnetwork：移除了与经典 Swarm 相关的未使用代码。[moby/moby#44965](https://github.com/moby/moby/pull/44965)
* libnetwork：从加密的 Swarm overlay 网络中移除了对 `xt_u32` 内核模块的使用。[moby/moby#45281](https://github.com/moby/moby/pull/45281)
* 移除了对 BuildKit 已弃用的 `buildinfo` 的支持，建议使用标准的来源证明 (provenance attestations)。[moby/moby#45097](https://github.com/moby/moby/pull/45097)
* 移除了已弃用的 AUFS 和旧版 `overlay` 存储驱动程序。[moby/moby#45342](https://github.com/moby/moby/pull/45342), [moby/moby#45359](https://github.com/moby/moby/pull/45359)
* 移除了已弃用的 `overlay2.override_kernel_check` 存储驱动程序选项。[moby/moby#45368](https://github.com/moby/moby/pull/45368)
* 从 AppArmor 配置文件中移除了针对过时版本 `apparmor_parser` 的变通方法。[moby/moby#45500](https://github.com/moby/moby/pull/45500)
* API：`GET /images/json` 在 API >= 1.43 上不再将空的 RepoTags 和 RepoDigests 表示为 `<none>:<none>`/`<none>@<none>`，而是返回空数组。[moby/moby#45068](https://github.com/moby/moby/pull/45068)

### 弃用

* 弃用了 `--oom-score-adjust` 守护进程选项。[moby/moby#45315](https://github.com/moby/moby/pull/45315)
* API：弃用了 `GET /images/json` 和 `GET /images/{id}/json` 中的 `VirtualSize` 字段。[moby/moby#45346](https://github.com/moby/moby/pull/45346)

### 错误修复与改进

* `docker stack` 命令不再验证 Compose 文件的 `build` 部分。[docker/cli#4214](https://github.com/docker/cli/pull/4214)
* 修复了达到超时时间后仍残留的健康检查进程。[moby/moby#43739](https://github.com/moby/moby/pull/43739)
* 减少了使用 `overlay2` 存储驱动程序时容器启动的开销。[moby/moby#44285](https://github.com/moby/moby/pull/44285)
* API：处理 `GET /images` 中的多个 `before=` 和 `since=` 过滤器。[moby/moby#44503](https://github.com/moby/moby/pull/44503)
* 修复了用户定义网络所使用的嵌入式 DNS 解析器实现中的众多 bug。[moby/moby#44664](https://github.com/moby/moby/pull/44664)
* 为事件属性映射添加了 `execDuration` 字段。[moby/moby#45494](https://github.com/moby/moby/pull/45494)
* 现在可以使用 Windows 的 `internal`、`l2bridge` 和 `nat` 驱动程序创建 Swarm 级网络。[moby/swarmkit#3121](https://github.com/moby/swarmkit/pull/3121), [moby/moby#45291](https://github.com/moby/moby/pull/45291)

### 打包更新

* 将 Go 更新至 `1.20.4`。[docker/cli#4253](https://github.com/docker/cli/pull/4253), [moby/moby#45456](https://github.com/moby/moby/pull/45456), [docker/docker-ce-packaging#888](https://github.com/docker/docker-ce-packaging/pull/888)
* 将 `containerd` 更新至 [`v1.7.1`](https://github.com/containerd/containerd/releases/tag/v1.7.1)。[moby/moby#45537](https://github.com/moby/moby/pull/45537)
* 将 `buildkit` 更新至 [`v0.11.6`](https://github.com/moby/buildkit/releases/tag/v0.11.6)。[moby/moby#45367](https://github.com/moby/moby/pull/45367)
