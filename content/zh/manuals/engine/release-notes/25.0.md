---
title: Docker Engine 25.0 发布说明
linkTitle: Engine v25.0
description: 了解 Docker Engine 25.0 版的新功能、错误修复和重大变更
keywords: docker, docker engine, ce, whats new, release notes, 发布说明
toc_min: 1
toc_max: 2
---

本页描述了 Docker Engine 25.0 版的最新变更、新增内容、已知问题和修复。

有关以下内容的更多信息：

- 已弃用和已移除的功能，请参阅 [已弃用的 Engine 功能](../deprecated.md)。
- Engine API 的变更，请参阅 [Engine API 版本历史](/reference/api/engine/version-history.md)。

## 25.0.5

{{< release-date date="2024-03-19" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 25.0.5 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A25.0.5)
- [moby/moby, 25.0.5 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A25.0.5)

### 安全

此版本包含对 [CVE-2024-29018] 的安全修复，该漏洞涉及可能通过权威 DNS 服务器从“内部”网络外泄数据。

### 错误修复与改进

- [CVE-2024-29018]：对于仅连接到“内部”网络的容器，不向外部 DNS 服务器转发请求。此前，如果主机的 DNS 服务器运行在回环地址上 (如 systemd 的 127.0.0.53)，请求会被转发。[moby/moby#47589](https://github.com/moby/moby/pull/47589)
- 插件：修复了在用户命名空间 (UserNS) 中运行进挂载 `/etc/hosts` 的问题。[moby/moby#47588](https://github.com/moby/moby/pull/47588)
- rootless：修复了 `open /etc/docker/plugins: permission denied` 错误。[moby/moby#47587](https://github.com/moby/moby/pull/47587)
- 修复了多个并行 `docker build` 运行导致磁盘空间泄漏的问题。[moby/moby#47527](https://github.com/moby/moby/pull/47527)

  [CVE-2024-29018]: https://github.com/moby/moby/security/advisories/GHSA-mq39-4gv4-mvpx

## 25.0.4

{{< release-date date="2024-03-07" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 25.0.4 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A25.0.4)
- [moby/moby, 25.0.4 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A25.0.4)

### 错误修复与改进

- 恢复了 Windows 上默认 "nat" 网络中容器的 DNS 名称。[moby/moby#47490](https://github.com/moby/moby/pull/47490)
- 修复了 `docker start` 在与 `--checkpoint` 配合使用时失败的问题 [moby/moby#47466](https://github.com/moby/moby/pull/47466)
- 不对现有的 Swarm 网络强制执行新的验证规则 [moby/moby#47482](https://github.com/moby/moby/pull/47482)
- 恢复了内部桥接网络上主机与容器之间的 IP 连通性。[moby/moby#47481](https://github.com/moby/moby/pull/47481)
- 修复了 v25.0 中引入的一个回归问题，该问题阻止了经典构建器添加在非 Linux 操作系统上创建的带有 `xattrs` 的 tar 归档文件 [moby/moby#47483](https://github.com/moby/moby/pull/47483)
- containerd 镜像存储：修复了镜像拉取不触发 `Pulling fs layer status` 状态的问题 [moby/moby#47484](https://github.com/moby/moby/pull/47484)
- API：为了保持向后兼容性，当使用旧客户端 (API 版本 < v1.44) 时，默认将只读挂载设为非递归。[moby/moby#47393](https://github.com/moby/moby/pull/47393)
- API：如果镜像配置中缺少 `Created` 字段，则 `GET /images/{id}/json` 会省略该字段 (此前为 `0001-01-01T00:00:00Z`)。[moby/moby#47451](https://github.com/moby/moby/pull/47451)
- API：对于 API 版本 <= 1.43，在 `GET /images/{id}/json` 中使用 `0001-01-01T00:00:00Z` 填充缺失的 `Created` 字段。[moby/moby#47387](https://github.com/moby/moby/pull/47387)
- API：修复了一个回归问题，该问题导致 API 套接字连接失败时错误地报告为 API 版本协商失败。[moby/moby#47470](https://github.com/moby/moby/pull/47470)
- API：在 container-create API 请求中，当指定了容器范围的 MAC 地址，但 `NetworkMode` 的名称或 ID 与 `NetworkSettings.Networks` 中使用的不一致时，保留提供的端点配置。[moby/moby#47510](https://github.com/moby/moby/pull/47510)

### 打包更新

- 将 Go 运行时更新至 1.21.8。[moby/moby#47503](https://github.com/moby/moby/pull/47503)
- 将 RootlessKit 更新至 v2.0.2。[moby/moby#47508](https://github.com/moby/moby/pull/47508)
- 将 Compose 更新至 v2.24.7。[docker/docker-ce-packaging#998](https://github.com/moby/moby/pull/998)
- 将 Buildx 更新至 v0.13.0。[docker/docker-ce-packaging#997](https://github.com/moby/moby/pull/997)

## 25.0.3

{{< release-date date="2024-02-06" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 25.0.3 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A25.0.3)
- [moby/moby, 25.0.3 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A25.0.3)

### 错误修复与改进

- containerd 镜像存储：修复了如果在内容存储中找不到清单，`docker image history` 会失败的 bug。[moby/moby#47348](https://github.com/moby/moby/pull/47348)
- 确保在容器重启时不还原生成的 MAC 地址，但保留配置的 MAC 地址。[moby/moby#47304](https://github.com/moby/moby/pull/47304)

  > [!NOTE]
  >
  > - 使用 Docker Engine 25.0.0 创建的容器可能具有重复的 MAC 地址。必须重新创建它们。
  > - 使用 25.0.0 或 25.0.1 版本创建的具有用户定义 MAC 地址的容器，在使用 25.0.2 启动时将获得新的 MAC 地址。它们也必须重新创建。

- 修复了 `docker save <image>@<digest>` 生成不含清单的 index OCI 归档的问题。[moby/moby#47294](https://github.com/moby/moby/pull/47294)
- 修复了在 RHEL 和 CentOS 7 上无法创建 MTU 大于 1500 的桥接网络的 bug。[moby/moby#47308](https://github.com/moby/moby/issues/47308), [moby/moby#47311](https://github.com/moby/moby/pull/47311)
- 修复了容器无法通过 `internal` 网络通信的 bug。[moby/moby#47303](https://github.com/moby/moby/pull/47303)
- 修复了 `ipv6` 守护进程选项值被忽略的 bug。[moby/moby#47310](https://github.com/moby/moby/pull/47310)
- 修复了尝试使用摘要版本安装插件时发生的崩溃 (panic)。[moby/moby#47323](https://github.com/moby/moby/pull/47323)
- 修复了受管 containerd 监督程序中潜在的竞态条件。[moby/moby#47313](https://github.com/moby/moby/pull/47313)
- 修复了 `journald` 日志驱动程序在 systemd 255 版本下无法正确跟随 (follow) 容器日志的问题。[moby/moby#47243](https://github.com/moby/moby/pull/47243)
- seccomp：更新了内置 seccomp 配置文件，包含在内核 v5.17 - v6.7 中添加的系统调用，使该配置文件与 containerd 使用的配置文件保持一致。[moby/moby#47341](https://github.com/moby/moby/pull/47341)
- Windows：修复了在构建基于比主机版本旧的 Windows 版本的镜像时未利用缓存的问题。[moby/moby#47307](https://github.com/moby/moby/issues/47307), [moby/moby#47337](https://github.com/moby/moby/pull/47337)

### 打包更新

- 停止对 Ubuntu Lunar (23.04) 的支持。[docker/ce-packaging#986](https://github.com/docker/docker-ce-packaging/pull/986)

## 25.0.2

{{< release-date date="2024-01-31" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 25.0.2 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A25.0.2)
- [moby/moby, 25.0.2 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A25.0.2)

### 安全

此版本包含针对影响 Docker Engine 及其组件的以下 CVE 的安全修复。

| CVE                                                         | 组件          | 修复版本    | 严重性           |
| ----------------------------------------------------------- | ------------- | ----------- | ---------------- |
| [CVE-2024-21626](https://scout.docker.com/v/CVE-2024-21626) | runc          | 1.1.12      | 高, CVSS 8.6   |
| [CVE-2024-23651](https://scout.docker.com/v/CVE-2024-23651) | BuildKit      | 1.12.5      | 高, CVSS 8.7   |
| [CVE-2024-23652](https://scout.docker.com/v/CVE-2024-23652) | BuildKit      | 1.12.5      | 高, CVSS 8.7   |
| [CVE-2024-23653](https://scout.docker.com/v/CVE-2024-23653) | BuildKit      | 1.12.5      | 高, CVSS 7.7   |
| [CVE-2024-23650](https://scout.docker.com/v/CVE-2024-23650) | BuildKit      | 1.12.5      | 中, CVSS 5.5 |
| [CVE-2024-24557](https://scout.docker.com/v/CVE-2024-24557) | Docker Engine | 25.0.2      | 中, CVSS 6.9 |

上述漏洞的潜在影响包括：

- 对主机文件系统的未经授权访问
- 破坏构建缓存的完整性
- 在 CVE-2024-21626 的情况下，可能导致完整的容器逃逸场景

有关此版本中解决的安全问题的更多信息，请参阅 [博客文章](https://www.docker.com/blog/docker-security-advisory-multiple-vulnerabilities-in-runc-buildkit-and-moby/)。有关每个漏洞的详情，请参阅相关的安全公告：

- [CVE-2024-21626](https://github.com/opencontainers/runc/security/advisories/GHSA-xr7r-f8xq-vfvv)
- [CVE-2024-23651](https://github.com/moby/buildkit/security/advisories/GHSA-m3r6-h7wv-7xxv)
- [CVE-2024-23652](https://github.com/moby/buildkit/security/advisories/GHSA-4v98-7qmw-rqr8)
- [CVE-2024-23653](https://github.com/moby/buildkit/security/advisories/GHSA-wr6v-9f75-vh2g)
- [CVE-2024-23650](https://github.com/moby/buildkit/security/advisories/GHSA-9p26-698r-w4hx)
- [CVE-2024-24557](https://github.com/moby/moby/security/advisories/GHSA-xw73-rw38-6vjc)

### 打包更新

- 将 containerd 更新至 [v1.6.28](https://github.com/containerd/containerd/releases/tag/v1.6.28)。
- 将 containerd 更新至 v1.7.13 (仅限静态二进制文件)。[moby/moby#47280](https://github.com/moby/moby/pull/47280)
- 将 runc 更新至 v1.1.12。[moby/moby#47269](https://github.com/moby/moby/pull/47269)
- 将 Compose 更新至 v2.24.5。[docker/docker-ce-packaging#985](https://github.com/docker/docker-ce-packaging/pull/985)
- 将 BuildKit 更新至 v0.12.5。[moby/moby#47273](https://github.com/moby/moby/pull/47273)

## 25.0.1

{{< release-date date="2024-01-23" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 25.0.1 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A25.0.1)
- [moby/moby, 25.0.1 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A25.0.1)

### 错误修复与改进

- API：修复了在升级到 Docker Engine v25.0 之前创建的、具有无效网络配置的容器返回错误 HTTP 状态码的问题。[moby/moby#47159](https://github.com/moby/moby/pull/47159)
- 确保当容器停止并重启时，重新生成基于容器 IP 地址的 MAC 地址，以防生成的 IP/MAC 地址已被重用。[moby/moby#47171](https://github.com/moby/moby/pull/47171)
- 修复了在不通过配置设置时，`host-gateway-ip` 在构建期间无法工作的问题。[moby/moby#47192](https://github.com/moby/moby/pull/47192)
- 修复了阻止容器被重命名两次的 bug。[moby/moby#47196](https://github.com/moby/moby/pull/47196)
- 修复了在检查容器时，导致容器短 ID 被添加到其网络别名的问题。[moby/moby#47182](https://github.com/moby/moby/pull/47182)
- 修复了检测远程构建上下文是否为 Git 仓库时的一个问题。[moby/moby#47136](https://github.com/moby/moby/pull/47136)
- 修复了 OCI 清单中层顺序的问题。[moby/moby#47150](https://github.com/moby/moby/issues/47150)
- 修复了传递 `addr` 或 `ip` 挂载选项时的卷挂载错误。[moby/moby#47185](https://github.com/moby/moby/pull/47185)
- 改进了与因命名空间属性名称不当而无法设置的扩展属性相关的错误消息。[moby/moby#47178](https://github.com/moby/moby/pull/47178)
- Swarm：修复了 `start_interval` 未被传递到容器配置的问题。[moby/moby#47163](https://github.com/moby/moby/pull/47163)

### 打包更新

- 将 Compose 更新至 `2.24.2`。[docker/docker-ce-packaging#981](https://github.com/docker/docker-ce-packaging/pull/981)

## 25.0.0

{{< release-date date="2024-01-19" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 25.0.0 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A25.0.0)
- [moby/moby, 25.0.0 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A25.0.0)

> [!NOTE]
>
> 在早期版本的 Docker Engine 中，递归挂载 (子挂载) 始终会被挂载为可写，即使指定了只读挂载。这一行为在 v25.0.0 中已针对运行在内核版本 5.12 或更高版本的主机发生了变化。现在，只读绑定挂载默认是 **递归只读 (recursively read-only)** 的。
>
> 要获得与早期版本相同的行为，您可以为 `--mount` 标志指定 `bind-recursive` 选项。
>
> ```console
> $ docker run --mount type=bind,src=SRC,dst=DST,readonly,bind-recursive=writable IMAGE
> ```
>
> 此选项在 `-v` 或 `--volume` 标志中不受支持。更多信息请参阅 [递归挂载](/manuals/engine/storage/bind-mounts.md#recursive-mounts)。

### 新增功能

- 守护进程现在使用 systemd 的默认 `LimitNOFILE`。在早期版本的 Docker Engine 中，此限制被设置为 `infinity`。这会导致最近版本的 systemd 出现问题，其中硬限制被增加，导致根据 ulimits 调整行为的程序消耗大量内存。[moby/moby#45534](https://github.com/moby/moby/pull/45534)

  新设置使容器的行为与主机上运行的程序一致，但可能会导致根据软限制做出错误假设的程序运行异常。要获得之前的行为，您可以设置 `LimitNOFILE=1048576`。

  此更改目前仅影响在使用 BuildKit 配合 `docker` 驱动程序时通过 `docker build` 创建的构建容器。未来的 containerd 版本也将使用此限制，这将导致此行为影响所有容器，而不只是构建容器。

  如果您在 systemd v240 或更高版本中遇到较高 ulimit 引起的问题，请考虑添加系统 `drop-in` 或 `override` 文件来为您的环境配置 ulimit 设置。[Flatcar Container Linux 文档](https://www.flatcar.org/docs/latest/setup/systemd/drop-in-units/) 有一篇非常详细介绍此主题的文章。

- 增加了 OpenTelemetry 追踪 (tracing) 支持。[moby/moby#45652](https://github.com/moby/moby/pull/45652), [moby/moby#45579](https://github.com/moby/moby/pull/45579)
- 增加了对 Linux 下 CDI 设备的支持。[moby/moby#45134](https://github.com/moby/moby/pull/45134), [docker/cli#4510](https://github.com/docker/cli/pull/4510), [moby/moby#46004](https://github.com/moby/moby/pull/46004)
- 增加了在容器启动期间供健康检查使用的额外间隔。[moby/moby#40894](https://github.com/moby/moby/pull/40894), [docker/cli#4405](https://github.com/docker/cli/pull/4405), [moby/moby#45965](https://github.com/moby/moby/pull/45965)
- 为 `dockerd` 增加了 `--log-format` 标志，用于控制日志格式：text (默认) 或 JSON。[moby/moby#45737](https://github.com/moby/moby/pull/45737)
- 增加了对递归只读挂载的支持。[moby/moby#45278](https://github.com/moby/moby/pull/45278), [moby/moby#46037](https://github.com/moby/moby/pull/46037)
- 增加了使用 `docker image ls --filter=until=<timestamp>` 根据时间戳过滤镜像的支持。[moby/moby#46577](https://github.com/moby/moby/pull/46577)

### 错误修复与改进

- API：修复了 `ValidateRestartPolicy` 中针对无效策略的错误消息。[moby/moby#46352](https://github.com/moby/moby/pull/46352)
- API：更新了 `/info` 端点以使用 singleflight。[moby/moby#45847](https://github.com/moby/moby/pull/45847)
- 增加了在使用 `-f` 指定 Dockerfile 文件名同时也使用 `stdin` 时的错误提示。[docker/cli#4346](https://github.com/docker/cli/pull/4346)
- 在 `--network` 长格式中增加了对 `mac-address` 和 `link-local-ip` 字段的支持。[docker/cli#4419](https://github.com/docker/cli/pull/4419)
- 增加了在 `docker container create` 和 `docker run` 中指定多个 `--network` 标志的支持。[moby/moby#45906](https://github.com/moby/moby/pull/45906)
- 当指定 IPv6 子网时，自动在网络上启用 IPv6。[moby/moby#46455](https://github.com/moby/moby/pull/46455)
- 增加了对基于 IPv6 传输的 overlay 网络的支持。[moby/moby#46790](https://github.com/moby/moby/pull/46790)
- 配置重新加载现在更加健壮：如果配置重新加载过程中发生错误，将不会应用任何配置更改。[moby/moby#43980](https://github.com/moby/moby/pull/43980)
- 实时恢复 (Live restore)：带有自动移除 (`docker run --rm`) 的容器在 Engine 重启时不再被强制移除。[moby/moby#46857](https://github.com/moby/moby/pull/46857)
- 实时恢复：被实时恢复的容器在守护进程重启时将获得另一个健康检查启动周期。[moby/moby#47051](https://github.com/moby/moby/pull/47051)
- 容器健康状态刷新到磁盘的频率降低，减少了对闪存存储的磨损。[moby/moby#47044](https://github.com/moby/moby/pull/47044)
- 确保网络名称唯一。[moby/moby#46251](https://github.com/moby/moby/pull/46251)
- 确保 overlay2 层元数据正确。[moby/moby#46471](https://github.com/moby/moby/pull/46471)
- 修复了镜像拉取时的 `Downloading` 进度消息。[moby/moby#46515](https://github.com/moby/moby/pull/46515)
- 修复并改进了 `NetworkConnect` 和 `ContainerCreate` 的数据验证，并一次性返回所有验证错误。[moby/moby#46183](https://github.com/moby/moby/pull/46183)
- 修复了启用 IPv6 和 ip6tables 时的 `com.docker.network.host_ipv4` 选项。[moby/moby#46446](https://github.com/moby/moby/pull/46446)
- 修复了 containerd 停止时的守护进程 `cleanupContainer`。[moby/moby#46213](https://github.com/moby/moby/pull/46213)
- 修复了 libnetwork 错误返回不正确 HTTP 状态码的问题。[moby/moby#46146](https://github.com/moby/moby/pull/46146)
- 修复了 images/json API 过滤器和镜像列表的各种问题。[moby/moby#46034](https://github.com/moby/moby/pull/46034)
- CIFS 卷现在可以正确解析 FQDN。[moby/moby#46863](https://github.com/moby/moby/pull/46863)
- 改进了 `userland-proxy-path` 守护进程配置选项的验证。现在验证在守护进程启动期间发生，而不是在启动带有端口映射的容器时产生错误。[moby/moby#47000](https://github.com/moby/moby/pull/47000)
- 当网络模式为短网络 ID 时设置容器接口的 MAC 地址。[moby/moby#46406](https://github.com/moby/moby/pull/46406)
- 在构建输出中显示前，对未使用的构建参数进行排序。[moby/moby#45917](https://github.com/moby/moby/pull/45917)
- `docker image save` 的 tarball 输出现在符合 OCI 标准。[moby/moby#44598](https://github.com/moby/moby/pull/44598)
- 守护进程不再为加密的 overlay 网络向 `INPUT` iptables 链末尾追加 `ACCEPT` 规则。根据防火墙配置，可能需要规则来允许传入的加密 overlay 网络流量。[moby/moby#45280](https://github.com/moby/moby/pull/45280)
- 将带有扩展属性的层解压到不兼容的文件系统上现在会失败，而不是静默丢弃扩展属性。[moby/moby#45464](https://github.com/moby/moby/pull/45464)
- 将守护进程 MTU 选项更新到 BridgeConfig，并在 Windows 上显示警告。[moby/moby#45887](https://github.com/moby/moby/pull/45887)
- 创建网络时验证 IPAM 配置。自动修复在此版本之前创建的、`--ip-range` 大于 `--subnet` 的网络。[moby/moby#45759](https://github.com/moby/moby/pull/45759)
- 仅连接到内部网络的容器现在将不设置默认路由，从而使 `connect` 系统调用快速失败。[moby/moby#46603](https://github.com/moby/moby/pull/46603)
- containerd 镜像存储：增加了针对 `push`、`pull` 和 `save` 的镜像事件。[moby/moby#46405](https://github.com/moby/moby/pull/46405)
- containerd 镜像存储：增加了对拉取旧版 schema1 镜像的支持。[moby/moby#46513](https://github.com/moby/moby/pull/46513)
- containerd 镜像存储：增加了对推送所有标签的支持。[moby/moby#46485](https://github.com/moby/moby/pull/46485)
- containerd 镜像存储：增加了对注册表令牌的支持。[moby/moby#46475](https://github.com/moby/moby/pull/46475)
- containerd 镜像存储：增加了显示使用镜像的容器数量的支持。[moby/moby#46511](https://github.com/moby/moby/pull/46511)
- containerd 镜像存储：修复了与 `ONBUILD`、`MAINTAINER` 和 `HEALTHCHECK` Dockerfile 指令相关的 bug。[moby/moby#46313](https://github.com/moby/moby/pull/46313)
- containerd 镜像存储：修复了 `Pulling from` 进度消息。[moby/moby#46494](https://github.com/moby/moby/pull/46494)
- containerd 镜像存储：增加了通过带有 `sha256:` 前缀的短 ID 引用镜像的支持。[moby/moby#46435](https://github.com/moby/moby/pull/46435)
- containerd 镜像存储：修复了 `docker images` 默认显示中间层的问题。[moby/moby#46423](https://github.com/moby/moby/pull/46423)
- containerd 镜像存储：修复了在获取镜像时检查指定平台是否存在的问题。[moby/moby#46495](https://github.com/moby/moby/pull/46495)
- containerd 镜像存储：修复了在使用经典构建器时使用多个 `ADD` 或 `COPY` 指令导致的错误。[moby/moby#46383](https://github.com/moby/moby/pull/46383)
- containerd 镜像存储：修复了导入镜像时发生的栈溢出错误。[moby/moby#46418](https://github.com/moby/moby/pull/46418)
- containerd 镜像存储：改进了 `docker pull` 的进度输出。[moby/moby#46412](https://github.com/moby/moby/pull/46412)
- containerd 镜像存储：推送镜像后打印标签、摘要和大小。[moby/moby#46384](https://github.com/moby/moby/pull/46384)
- containerd 镜像存储：从 `UpdateConfig` 中移除了崩溃 (panic)。[moby/moby#46433](https://github.com/moby/moby/pull/46433)
- containerd 镜像存储：当镜像标签类似于摘要时返回错误。[moby/moby#46492](https://github.com/moby/moby/pull/46492)
- containerd 镜像存储：`docker image ls` 现在显示正确的镜像创建时间和日期。[moby/moby#46719](https://github.com/moby/moby/pull/46719)
- containerd 镜像存储：修复了处理用户命名空间设置时的一个问题。[moby/moby#46375](https://github.com/moby/moby/pull/46375)
- containerd 镜像存储：增加了对拉取所有标签 (`docker pull -a`) 的支持。[moby/moby#46618](https://github.com/moby/moby/pull/46618)
- containerd 镜像存储：使用镜像引用中的域名作为默认的注册表身份验证域名。[moby/moby#46779](https://github.com/moby/moby/pull/46779)

### 打包更新

- 将 API 更新至 v1.44。[moby/moby#45468](https://github.com/moby/moby/pull/45468)
- 将 Compose 更新至 `2.24.1`。[docker/docker-ce-packaging#980](https://github.com/docker/docker-ce-packaging/pull/980)
- 将 containerd 更新至 v1.7.12 (仅限静态二进制文件)。[moby/moby#47070](https://github.com/moby/moby/pull/47070)
- 将 Go 运行时更新至 [1.21.6](https://go.dev/doc/devel/release#go1.21.minor)。[moby/moby#47053](https://github.com/moby/moby/pull/47053)
- 将 runc 更新至 v1.1.11。[moby/moby#47007](https://github.com/moby/moby/pull/47007)
- 将 BuildKit 更新至 v0.12.4。[moby/moby#46882](https://github.com/moby/moby/pull/46882)
- 将 Buildx 更新至 v0.12.1。[docker/docker-ce-packaging#979](https://github.com/docker/docker-ce-packaging/pull/979)

### 已移除

- API：从 `GET /images/json` 和 `GET /images/{id}/json` 端点中移除了 `VirtualSize` 字段。[moby/moby#45469](https://github.com/moby/moby/pull/45469)
- 移除了已弃用的 `devicemapper` 存储驱动程序。[moby/moby#43637](https://github.com/moby/moby/pull/43637)
- 移除了已弃用的编排器 (orchestrator) 选项。[docker/cli#4366](https://github.com/docker/cli/pull/4366)
- 移除了对 Debian Upstart init 系统的支持。[moby/moby#45548](https://github.com/moby/moby/pull/45548), [moby/moby#45551](https://github.com/moby/moby/pull/45551)
- 移除了 `--oom-score-adjust` 守护进程选项。[moby/moby#45484](https://github.com/moby/moby/pull/45484)
- 移除了针对已弃用 `~/.dockercfg` 文件的警告。[docker/cli#4281](https://github.com/docker/cli/pull/4281)
- 移除了 `logentries` 日志驱动程序。[moby/moby#46925](https://github.com/moby/moby/pull/46925)

### 弃用

- 弃用了 1.24 之前的 API 版本。[弃用通知](../deprecated.md#deprecate-legacy-api-versions)
- 弃用了 `docker search` 的 `IsAutomated` 字段和 `is-automated` 过滤器。[弃用通知](../deprecated.md#isautomated-field-and-is-automated-filter-on-docker-search)
- API：弃用了 `/images/{id}/json` (`docker image inspect`) 的 `Container` 和 `ContainerConfig` 属性。[moby/moby#46939](https://github.com/moby/moby/pull/46939)

### 已知限制

#### tar 文件的扩展属性

在此版本中，处理 `tar` 归档文件的代码变得更加严格，且在无法写入扩展属性 (`xattr`) 时会产生错误。macOS 的 `tar` 实现默认在创建 tar 文件时会生成额外的扩展属性。这些属性前缀不是有效的 Linux `xattr` 命名空间前缀，这会导致 Docker 在尝试处理这些文件时报错。例如，如果您尝试通过 `ADD` Dockerfile 指令使用一个 tar 文件，可能会看到类似以下的错误消息：

```text
failed to solve: lsetxattr /sftp_key.ppk: operation not supported
```

关于扩展属性验证的错误消息在 [v25.0.1](#2501) 中得到了改进，包含了更多上下文，但 Docker 无法处理这些文件的限制仍然存在。使用 macOS `tar` 且带默认参数创建的 tar 文件在与 Docker 配合使用时会产生错误。

作为变通方法，如果您需要将 macOS 生成的 tar 文件用于 Docker，您可以：

- 使用 macOS `tar` 命令的 `--no-xattr` 标志来剥离 **所有** 扩展属性。如果您想要保留扩展属性，则不推荐此选项。
- 在 macOS 上安装并使用 `gnu-tar` 代替默认的 `tar` 实现来创建 tar 包。要使用 Homebrew 安装 `gnu-tar`：

  ```console
  $ brew install gnu-tar
  ```

  安装后，将 `gnu-tar` 二进制文件添加到您的 `PATH` 中，例如通过更新您的 `.zshrc` 文件：

  ```console
  $ echo 'PATH="/opt/homebrew/opt/gnu-tar/libexec/gnubin:$PATH"' >> ~/.zshrc
  $ source ~/.zshrc
  ```
