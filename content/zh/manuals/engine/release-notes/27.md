---
title: Docker Engine 27 版发布说明
linkTitle: Engine v27
description: 了解 Docker Engine 27 版的新功能、错误修复和重大变更
keywords: docker, docker engine, ce, whats new, release notes, 发布说明
toc_min: 1
toc_max: 2
tags:
  - Release notes
aliases:
- /engine/release-notes/27.1/
- /engine/release-notes/27.0/
---

本页描述了 Docker Engine 27 版的最新变更、新增内容、已知问题和修复。

有关以下内容的更多信息：

- 已弃用和已移除的功能，请参阅 [已弃用的 Engine 功能](../deprecated.md)。
- Engine API 的变更，请参阅 [Engine API 版本历史](/reference/api/engine/version-history.md)。

## 27.5

Docker Engine 27.5 系列的发布说明。

### 27.5.1

{{< release-date date="2025-01-22" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.5.1 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.5.1)
- [moby/moby, 27.5.1 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.5.1)


#### 错误修复与改进

- 修复了在初始化默认桥接网络失败后，可能持久性阻止守护进程启动的问题。[moby/moby#49307](https://github.com/moby/moby/pull/49307)
- 添加了 `DOCKER_IGNORE_BR_NETFILTER_ERROR` 环境变量。将其设置为 `1` 允许在无法加载 `br_netfilter` 的主机上运行。但某些功能将无法工作，包括禁用桥接网络中的容器间通信。在禁用用户空间代理的情况下，将无法从同一网络上的另一个容器访问某个容器的已发布端口。[moby/moby#49306](https://github.com/moby/moby/pull/49306)

#### 打包更新

- 将 Go 运行时更新至 1.22.11 (修复 CVE-2024-45341, CVE-2024-45336)。[moby/moby#49312](https://github.com/moby/moby/pull/49312), [docker/docker-ce-packaging#1147](https://github.com/docker/docker-ce-packaging/pull/1147), [docker/cli#5762](https://github.com/docker/cli/pull/5762)
- 将 RootlessKit 更新至 v2.3.2 以支持 `passt` >= 2024_10_30.ee7d0b6。[moby/moby#49304](https://github.com/moby/moby/pull/49304)
- 将 Buildx 更新至 [v0.20.0](https://github.com/docker/buildx/releases/tag/v0.20.0)。[docker/docker-ce-packaging#1149](https://github.com/docker/docker-ce-packaging/pull/1149)


### 27.5.0

{{< release-date date="2025-01-13" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.5.0 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.5.0)
- [moby/moby, 27.5.0 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.5.0)

#### 错误修复与改进

- containerd 镜像存储：修复了通过 tarball 向 `/build` 端点传递构建上下文的问题。[moby/moby#49194](https://github.com/moby/moby/pull/49194)
- 没有 `keepStorage` 值的构建器垃圾回收策略现在按预期继承 `defaultKeepStorage` 限制。[moby/moby#49137](https://github.com/moby/moby/pull/49137)
- 在守护进程启动期间保留网络标签。[moby/moby#49200](https://github.com/moby/moby/pull/49200)
- 修复了删除容器时潜在的竞态条件错误。[moby/moby#49239](https://github.com/moby/moby/pull/49239)

#### Go SDK

- `pkg/sysinfo`：弃用 `NumCPU`。此工具的行为与 `runtime.NumCPU` 相同。[moby/moby#49247](https://github.com/moby/moby/pull/49247)
- `pkg/fileutils`：弃用 `GetTotalUsedFds`：此函数仅在内部使用，将在下一个版本中移除。[moby/moby#49209](https://github.com/moby/moby/pull/49209)
- `pkg/ioutils`：弃用 `BytesPipe`、`NewBytesPipe`、`ErrClosed`、`WriteCounter`、`NewWriteCounter`、`NewReaderErrWrapper`、`NopFlusher`、`NopWriter`、`NopWriteCloser`。它们仅在内部使用，将在下一个版本中移除。[moby/moby#49246](https://github.com/moby/moby/pull/49246), [moby/moby#49255](https://github.com/moby/moby/pull/49255)
- `pkg/reexec`：此包已弃用并移至独立模块。请改用 `github.com/moby/sys/reexec`。[moby/moby#49135](https://github.com/moby/moby/pull/49135)

#### 打包更新
- 将 containerd 更新至 [v1.7.25](https://github.com/containerd/containerd/releases/tag/v1.7.25) [moby/moby#49253](https://github.com/moby/moby/pull/49253)
- 将 `runc` 更新至 [v1.2.4](https://github.com/opencontainers/runc/releases/tag/v1.2.4) [moby/moby#49243](https://github.com/moby/moby/pull/49243)
- 将 BuildKit 更新至 [v0.18.2](https://github.com/moby/buildkit/releases/tag/v0.18.2) [moby/moby#48949](https://github.com/moby/moby/pull/48949)
- 将 Compose 更新至 [v2.32.2](https://github.com/docker/compose/releases/tag/v2.32.2) [docker/docker-ce-packaging#1140](https://github.com/docker/docker-ce-packaging/pull/1140)

## 27.4

Docker Engine 27.4 系列的发布说明。

### 27.4.1

{{< release-date date="2024-12-18" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.4.1 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.4.1)
- [moby/moby, 27.4.1 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.4.1)

#### 错误修复与改进

- 修复了未配置 OTel 时过多的内存分配问题。[moby/moby#49079](https://github.com/moby/moby/pull/49079)
- `docker info` 命令和相应的 `GET /info` API 端点在守护进程启动时禁用 `bridge-nf-call-iptables` 或 `bridge-nf-call-ip6tables` 时不再包含警告。现在会在需要时尝试加载 `br_netfilter` 内核模块，这使得之前的警告不再准确。[moby/moby#49090](https://github.com/moby/moby/pull/49090)
- 尝试在需要时加载内核模块 (包括 `ip6_tables` 和 `br_netfilter`)，使用了一种在 Docker-in-Docker 容器内更有可能成功的方法。[moby/moby#49043](https://github.com/moby/moby/pull/49043)
- 修复了一个 bug，该 bug 可能导致 iptables `DOCKER FILTER` 链在失败时未被清理。[moby/moby#49110](https://github.com/moby/moby/pull/49110)

#### 打包更新

- 将 Compose 更新至 [v2.32.1](https://github.com/docker/compose/releases/tag/v2.32.1)。[docker/docker-ce-packaging#1130](https://github.com/docker/docker-ce-packaging/pull/1130)
- 将 Buildx 更新至 [v0.19.3](https://github.com/docker/buildx/releases/tag/v0.19.3)。[docker/docker-ce-packaging#1132](https://github.com/docker/docker-ce-packaging/pull/1132)
- 将 runc (仅限静态二进制文件) 更新至 [v1.2.3](https://github.com/opencontainers/runc/releases/tag/v1.2.3) [moby/moby#49085](https://github.com/moby/moby/pull/49085)

### 27.4.0

{{< release-date date="2024-12-09" >}}


有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.4.0 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.4.0)
- [moby/moby, 27.4.0 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.4.0)

#### API

- 开启 `manifests` 选项后的 `GET /images/json` 现在保留了清单在 manifest-index 中出现的原始顺序。[moby/moby#48712](https://github.com/moby/moby/pull/48712)

#### 错误修复与改进

- 使用 `jsonfile` 或 `local` 日志驱动程序读取日志时，尝试读取或解析底层日志文件时的任何错误都将导致跳过该文件的剩余部分并移动到下一个日志文件 (如果存在)，而不是向客户端返回错误并关闭流。这些错误可以在 Docker 守护进程日志中查看，并在配置了追踪时导出到 traces。[moby/moby#48842](https://github.com/moby/moby/pull/48842)
- 读取日志文件时，压缩的日志文件现在仅在需要时才解压，而不是在开始日志流之前解压所有文件。[moby/moby#48842](https://github.com/moby/moby/pull/48842)
- 修复了一个问题，即如果内核的 `br_netfilter` 模块未加载并启用，则在禁用 `userland-proxy` 的情况下，桥接网络上一个容器发布的端口无法被同一网络上的另一个容器访问。守护进程现在会在禁用用户空间代理创建网络时，尝试加载该模块并启用 `bridge-nf-call-iptables` 或 `bridge-nf-call-ip6tables`。[moby/moby#48685](https://github.com/moby/moby/pull/48685)
- 修复了 `bridge` 和 `br_netfilter` 内核模块的加载问题。[moby/moby#48966](https://github.com/moby/moby/pull/48966)
- containerd 镜像存储：修复了 Docker 守护进程在存在大量构建/镜像且使用 containerd 快照器时，因 "context deadline exceeded error" 无法完全启动的问题。[moby/moby#48954](https://github.com/moby/moby/pull/48954)
- containerd 镜像存储：修复了部分拉取的镜像未被垃圾回收的问题。[moby#48910](https://github.com/moby/#48910), [moby/moby#48957](https://github.com/moby/moby/pull/48957)
- containerd 镜像存储：修复了 `docker image inspect` 在 `RepoDigests` 中输出重复引用的问题。[moby/moby#48785](https://github.com/moby/moby/pull/48785)
- containerd 镜像存储：修复了在 HTTPS 请求因非 TLS 相关错误而失败的情况下，无法连接到某些不安全注册表的问题。[moby/moby#48758](https://github.com/moby/moby/pull/48758)
- containerd 镜像存储：移除了标记非悬空镜像时的混淆警告日志。[moby/moby#49010](https://github.com/moby/moby/pull/49010)
- containerd 镜像存储：在 `docker image ls --tree` 中不再对名称加下划线。[docker/cli#5519](https://github.com/docker/cli/pull/5519)
- containerd 镜像存储：将 `docker image ls --tree` 中的 `USED` 列更名为 `IN USE`。[docker/cli#5518](https://github.com/docker/cli/pull/5518)
- `dockerd-rootless-setuptool.sh install --force` 现在忽略 RootlessKit 错误 [moby/moby#48695](https://github.com/moby/moby/pull/48695)
- 针对分配给属于桥接网络网桥的地址，禁用 IPv6 重复地址检测 (DAD)。[moby/moby#48684](https://github.com/moby/moby/pull/48684)
- 移除了 BuildKit 初始化超时。[moby/moby#48963](https://github.com/moby/moby/pull/48963)
- 移除 ZFS 数据集时忽略 "dataset does not exist" 错误。[moby/moby#48968](https://github.com/moby/moby/pull/48968)
- 客户端：防止空闲连接泄漏文件描述符 (FD)。[moby/moby#48764](https://github.com/moby/moby/pull/48764)
- 修复了通过 `--mount` 选项创建的匿名卷未被标记为匿名的问题。[moby/moby#48755](https://github.com/moby/moby/pull/48755)
- 在带实时恢复的守护进程重启后，确保跳转到 `DOCKER-USER` 链的 iptables 规则放置在其他规则之前。[moby/moby#48714](https://github.com/moby/moby/pull/48714)
- 修复了由 OTel meters 引起的可能内存泄漏。[moby/moby#48693](https://github.com/moby/moby/pull/48693)
- 为每个镜像存储创建独立的构建历史数据库。[moby/moby#48688](https://github.com/moby/moby/pull/48688)
- 修复了在紧凑循环中进行 DNS 解析时导致内存占用过高的问题。[moby/moby#48840](https://github.com/moby/moby/pull/48840)
- 修复了在 `docker run` 期间阻止镜像拉取操作被取消的 bug。[docker/cli#5654](https://github.com/docker/cli/pull/5654)
- `docker login` 和 `docker logout` 命令在凭据未发生变化时不再更新配置文件。[docker/cli#5569](https://github.com/docker/cli/pull/5569)
- 优化了 `docker stats` 以减少闪烁问题。[docker/cli#5588](https://github.com/docker/cli/pull/5588), [docker/cli#5635](https://github.com/docker/cli/pull/5635)
- 修复了不可访问的插件路径阻止插件被检测到的问题。[docker/cli#5652](https://github.com/docker/cli/pull/5652)
- 在 cobra 生成的 shell 补全中添加了对 `events --filter` 的支持。[docker/cli#5614](https://github.com/docker/cli/pull/5614)
- 修复了 `events --filter daemon=` 的 bash 补全。[docker/cli#5563](https://github.com/docker/cli/pull/5563)
- 改进了 `docker rm` 对容器的 shell 补全。[docker/cli#5540](https://github.com/docker/cli/pull/5540)
- 添加了对 `--platform` 标志的 shell 补全。[docker/cli#5540](https://github.com/docker/cli/pull/5540)
- rootless：使 `/etc/cdi` 和 `/var/run/cdi` 可被容器设备接口 (CDI) 集成访问。[moby/moby#49027](https://github.com/moby/moby/pull/49027)

#### 已移除

- 弃用 `Daemon.Exists()` 和 `Daemon.IsPaused()`。这些函数已不再使用，将在下一个版本中移除。[moby/moby#48719](https://github.com/moby/moby/pull/48719)
- 弃用 `container.ErrNameReserved` 和 `container.ErrNameNotReserved`。[moby/moby#48697](https://github.com/moby/moby/pull/48697)
- 弃用 `pkg/platform` - 此包仅在内部使用，将在下一个版本中移除。[moby/moby#48863](https://github.com/moby/moby/pull/48863)
- 弃用 `RepositoryInfo.Class`。此字段已不再使用，将在下一个版本中移除。[moby/moby#49013](https://github.com/moby/moby/pull/49013)
- Go SDK：修正了 `cli/command.ConfigureAuth()` 的弃用状态，其自 v27.2.1 起已弃用。[docker/cli#5552](https://github.com/docker/cli/pull/5552)
- Go SDK：弃用 `cli.Errors` 类型，建议使用 Go 的 `errors.Join` [docker/cli#5548](https://github.com/docker/cli/pull/5548)

#### 打包更新

- 将 Go 运行时更新至 1.22.10。[moby/moby#49026](https://github.com/moby/moby/pull/49026), [docker/cli#5669](https://github.com/docker/cli/pull/5669), [docker/docker-ce-packaging#1120](https://github.com/docker/docker-ce-packaging/pull/1120)。
- 将 Compose 更新至 [v2.31.0](https://github.com/docker/compose/releases/tag/v2.31.0)。[docker/docker-ce-packaging#1117](https://github.com/docker/docker-ce-packaging/pull/1117)
- 将 BuildKit 更新至 [v0.17.3](https://github.com/moby/buildkit/releases/tag/v0.17.3)。[moby/moby#49024](https://github.com/moby/moby/pull/49024)
- 将 Buildx 更新至 [v0.19.1](https://github.com/docker/buildx/releases/tag/v0.19.1)。[docker/docker-ce-packaging#1115](https://github.com/docker/docker-ce-packaging/pull/1115)
- 将 containerd 更新至 [v1.7.24](https://github.com/containerd/containerd/releases/tag/v1.7.24)。[moby/moby#48934](https://github.com/moby/moby/pull/48934)
- 将 containerd (仅限静态二进制文件) 更新至 [v1.7.24](https://github.com/containerd/containerd/releases/tag/v1.7.24)。[moby/moby#48919](https://github.com/moby/moby/pull/48919)
- 将 runc 更新至 [v1.2.2](https://github.com/opencontainers/runc/releases/tag/v1.2.2)。[moby/moby#48919](https://github.com/moby/moby/pull/48919)


## 27.3

Docker Engine 27.3 系列的发布说明。

### 27.3.1

{{< release-date date="2024-09-20" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.3.1 里程碑](https://github.com/docker/cli/issues?q=sort%3Aupdated-desc+is%3Aclosed+milestone%3A27.3.1)
- [moby/moby, 27.3.1 里程碑](https://github.com/moby/moby/issues?q=sort%3Aupdated-desc+is%3Aclosed+milestone%3A27.3.1)

#### 错误修复与改进

- CLI：修复了命令执行指标未被正确导出的问题。[docker/cli#5457](https://github.com/docker/cli/pull/5457)

#### 打包更新

- 将 Compose 更新至 [v2.29.7](https://github.com/docker/compose/releases/tag/v2.29.7)

### 27.3.0

{{< release-date date="2024-09-19" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.3.0 里程碑](https://github.com/docker/cli/issues?q=sort%3Aupdated-desc+is%3Aclosed+milestone%3A27.3.0)
- [moby/moby, 27.3.0 里程碑](https://github.com/moby/moby/issues?q=sort%3Aupdated-desc+is%3Aclosed+milestone%3A27.3.0)

#### 错误修复与改进

- containerd 镜像存储：修复了 `docker image prune -a` 会移除由摘要引用的镜像所启动的容器正在使用的镜像标签的问题。[moby/moby#48488](https://github.com/moby/moby/pull/48488)
- 在守护进程选项中添加了 `--feature` 标志。[moby/moby#48487](https://github.com/moby/moby/pull/48487)
- 更新了对 `--gpus=0` 标志的处理，使其与 NVIDIA Container Runtime 保持一致。[moby/moby#48483](https://github.com/moby/moby/pull/48483)
- 支持 WSL2 镜像模式联网 (mirrored-mode networking) 对来自 Windows 主机数据包所使用的 `loopback0` 接口。[moby/moby#48514](https://github.com/moby/moby/pull/48514)
- 修复了在运行 `--iptables=false`、`--ip6tables=true` (默认) 时，在通常不加载 `br_netfilter` 内核模块的主机上，防火墙对转发数据包设置了 DROP 规则，从而阻止 IPv4 桥接网络上容器间通信的问题。[moby/moby#48511](https://github.com/moby/moby/pull/48511)
- CLI：修复了如果没有传递参数/卷，`docker volume update` 命令会导致 CLI 崩溃的问题。[docker/cli#5426](https://github.com/docker/cli/pull/5426)
- CLI：在 Windows 的 WSL 环境中运行时，可以正确报告指标。[docker/cli#5432](https://github.com/docker/cli/pull/5432)

#### 打包更新

- 将 containerd (仅限静态二进制文件) 更新至 [v1.7.22](https://github.com/containerd/containerd/releases/tag/v1.7.22) [moby/moby#48468](https://github.com/moby/moby/pull/48468)
- 将 BuildKit 更新至 [v0.16.0](https://github.com/moby/buildkit/releases/tag/v0.16.0)
- 将 Compose 更新至 [v2.29.6](https://github.com/docker/compose/releases/tag/v2.29.6)
- 将 Buildx 更新至 [v0.17.1](https://github.com/docker/buildx/releases/tag/v0.17.1)

## 27.2

Docker Engine 27.2 系列的发布说明。

### 27.2.1

{{< release-date date="2024-09-09" >}}

#### 错误修复与改进

- containerd 镜像存储：修复了非容器镜像在 `docker image ls` 输出中被隐藏的问题。[moby/moby#48402](https://github.com/moby/moby/pull/48402)
- containerd 镜像存储：改进了当镜像平台不匹配时 `docker pull` 的错误消息。[moby/moby#48415](https://github.com/moby/moby/pull/48415)
- CLI：修复了导致 `docker login` 未从传入的注册表地址中移除仓库名称，导致凭据存储在错误键下的问题。[docker/cli#5385](https://github.com/docker/cli/pull/5385)
- CLI：修复了如果 CLI 进程在等待用户身份验证时挂起然后恢复，有时会导致浏览器登录流程失败的问题。[docker/cli#5376](https://github.com/docker/cli/pull/5376)
- CLI：`docker login` 现在在非交互式调用且带有 `--password` 或 `--password-stdin` 但没有 `--user` 时，返回错误而不是挂起。[docker/cli#5402](https://github.com/docker/cli/pull/5402)

#### 打包更新

- 将 runc 更新至 v1.1.14，包含对 [CVE-2024-45310](https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv) 的修复。[moby/moby#48426](https://github.com/moby/moby/pull/48426)
- 将 Go 运行时更新至 1.22.7。[moby/moby#48433](https://github.com/moby/moby/pull/48433), [docker/cli#5411](https://github.com/docker/cli/pull/5411), [docker/docker-ce-packaging#1068](https://github.com/docker/docker-ce-packaging/pull/1068)

### 27.2.0

{{< release-date date="2024-08-27" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.2.0 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.2.0)
- [moby/moby, 27.2.0 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.2.0)
- 已弃用和已移除的功能，请参阅 [已弃用的功能](https://github.com/docker/cli/blob/v27.2.0/docs/deprecated.md)。
- Engine API 的变更，请参阅 [API 版本历史](https://github.com/moby/moby/blob/v27.2.0/docs/api/version-history.md)。

#### 新增功能

此版本中的新功能包括：

- [设备代码登录 (Device code login)](#device-code-login)
- [`docker image ls` 的多平台支持](#multi-platform-support-for-docker-image-ls)

##### 设备代码登录

此版本增加了对在向 Docker Hub 身份验证时使用设备代码登录的支持。

您仍然可以使用旧的用户名加密码或访问令牌的登录方式，但设备代码登录更安全，且不需要在 CLI 中输入密码。

![device-code-login](https://i.imgur.com/GRGjSjV.gif "设备代码登录")

要使用旧方法，请使用 `docker login -u <用户名>`。

##### `docker image ls` 的多平台支持

{{< experimental >}}
这是实验性功能，可能会随时更改且不保证向后兼容性。
{{< /experimental >}}

在启用 containerd 镜像存储的情况下，`docker image ls` 命令 (或 `docker images` 简写) 现在支持 `--tree` 标志，可以显示镜像是否为多平台镜像。

<script src="https://asciinema.org/a/PyE57rUPdNh7LvOMhULtE0Ek2.js" id="asciicast-PyE57rUPdNh7LvOMhULtE0Ek2" async="true"></script>

#### API

- `GET /images/json` 响应现在包含 `Manifests` 字段，其中包含有关镜像索引中包含的子清单的信息。这包括平台特定的清单和构建证明等内容。

  仅当请求也将 `manifests` 查询参数设置为 `true` 时，才会填充新字段。

  {{< experimental >}}
  这是实验性功能，可能会随时更改且不保证向后兼容性。
  {{< /experimental >}}

#### 错误修复与改进

- CLI：修复了通过 SSH 进行远程上下文连接的问题，CLI 在连接到远程主机时会分配一个伪 TTY，这在极少数情况下会导致问题。[docker/cli#5351](https://github.com/docker/cli/pull/5351)
- 修复了一个阻止使用以 64 位边界结束的 `--ip-range` 创建网络的问题。[moby/moby#48326](https://github.com/moby/moby/pull/48326)
- CLI：`docker ps` 在端口绑定中显示的 IPv6 地址现在带有方括号。[docker/cli#5365](https://github.com/docker/cli/pull/5365)
- containerd 镜像存储：修复了在镜像解压失败的情况下，`docker load` 会过早错误退出的问题。[moby/moby#48376](https://github.com/moby/moby/pull/48376)
- containerd 镜像存储：修复了 `docker pull` 后前一个镜像未被保留为悬空镜像的问题。[moby/moby#48380](https://github.com/moby/moby/pull/48380)

#### 打包更新

- 将 BuildKit 更新至 [v0.15.2](https://github.com/moby/buildkit/releases/tag/v0.15.2)。[moby/moby#48341](https://github.com/moby/moby/pull/48341)
- 将 Compose 更新至 [v2.29.2](https://github.com/docker/compose/releases/tag/v2.29.2)。[docker/docker-ce-packaging#1050](https://github.com/docker/docker-ce-packaging/pull/1050)
- 将 containerd 更新至 [v1.7.21](https://github.com/containerd/containerd/releases/tag/v1.7.21)。[moby/moby#48383](https://github.com/moby/moby/pull/48383), [docker/containerd-packaging#389](https://github.com/docker/containerd-packaging/pull/389)

### 已知问题

- Docker CLI 在对注册表进行身份验证时存在一个已知问题 (`docker login [注册表地址]`)：如果提供的注册表地址包含仓库/镜像名称 (例如 `docker login index.docker.io/docker/welcome-to-docker`)，仓库部分 (`docker/welcome-to-docker`) 不会被标准化，导致凭据存储错误，从而导致后续从该注册表拉取镜像 (`docker pull index.docker.io/docker/welcome-to-docker`) 无法通过身份验证。为防止此问题，在运行 `docker login` 时不要在注册表地址中包含任何无关的后缀。
  > [!NOTE]
  > 使用包含 URL 路径段的地址运行 `docker login` 不是一个已记录的用例，被视为不受支持。推荐的用法是仅指定注册表主机名 (以及可选的端口) 作为 `docker login` 的地址。

## 27.1

Docker Engine 27.1 系列的发布说明。

### 27.1.2

{{< release-date date="2024-08-13" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.1.2 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.1.2)
- [moby/moby, 27.1.2 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.1.2)
- 已弃用和已移除的功能，请参阅 [已弃用的功能](https://github.com/docker/cli/blob/v27.1.2/docs/deprecated.md)。
- Engine API 的变更，请参阅 [API 版本历史](https://github.com/moby/moby/blob/v27.1.2/docs/api/version-history.md)。


#### 错误修复与改进

- 修复了一个回归问题，该问题可能导致从大型 Dockerfile 构建时出现 `ResourceExhausted desc = grpc: received message larger than max` 错误。[moby/moby#48245](https://github.com/moby/moby/pull/48245)
- CLI：修复了 `docker attach` 打印虚假的 `context cancelled` 错误消息的问题。[docker/cli#5296](https://github.com/docker/cli/pull/5296)
- CLI：修复了 `docker attach` 在接收到 `SIGINT` 时退出，而不是将信号转发给容器并等待其退出的问题。[docker/cli#5302](https://github.com/docker/cli/pull/5302)
- CLI：修复了 `--device-read-bps` 和 `--device-write-bps` 选项未生效的问题。[docker/cli#5339](https://github.com/docker/cli/pull/5339)
- CLI：修复了在某些情况下运行插件时发生的崩溃 (panic)。[docker/cli#5337](https://github.com/docker/cli/pull/5337)


#### 打包更新

- 将 BuildKit 更新至 [v0.15.1](https://github.com/moby/buildkit/releases/tag/v0.15.1)。[moby/moby#48246](https://github.com/moby/moby/pull/48246)
- 将 Buildx 更新至 [v0.16.2](https://github.com/docker/buildx/releases/tag/v0.16.2)。[docker/docker-ce-packaging#1043](https://github.com/docker/docker-ce-packaging/pull/1043)
- 将 Go 运行时更新至 1.21.13。[moby/moby#48301](https://github.com/moby/moby/pull/48301), [docker/cli#5325](https://github.com/docker/cli/pull/5325), [docker/docker-ce-packaging#1046](https://github.com/docker/docker-ce-packaging/pull/1046)
- 从 Windows 软件包中移除了未使用的 `docker-proxy.exe` 二进制文件。[docker/docker-ce-packaging#1045](https://github.com/docker/docker-ce-packaging/pull/1045)

### 27.1.1

{{< release-date date="2024-07-23" >}}

#### 安全

此版本包含对 [CVE-2024-41110](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-41110) / [GHSA-v23v-6jw2-98fq](https://github.com/moby/moby/security/advisories/GHSA-v23v-6jw2-98fq) 的修复，该漏洞影响了使用 [授权插件 (AuthZ)](https://docs.docker.com/engine/extend/plugins_authorization/) 进行访问控制的设置。此版本未包含其他更改，对于不使用 AuthZ 插件的用户，此版本与之前版本完全一致。

#### 打包更新

- 将 Compose 更新至 [v2.29.1](https://github.com/docker/compose/releases/tag/v2.29.1)。[moby/docker-ce-packaging#1041](https://github.com/docker/docker-ce-packaging/pull/1041)


### 27.1.0

{{< release-date date="2024-07-22" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.1.0 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.1.0)
- [moby/moby, 27.1.0 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.1.0)
- 已弃用和已移除的功能，请参阅 [已弃用的功能](https://github.com/docker/cli/blob/v27.1.0/docs/deprecated.md)。
- Engine API 的变更，请参阅 [API 版本历史](https://github.com/moby/moby/blob/v27.1.0/docs/api/version-history.md)。

#### 错误修复与改进

- rootless：添加了 `Requires=dbus.socket`，以防止在带有 systemd 的 cgroup v2 主机上启动守护进程时出现错误 [moby/moby#48141](https://github.com/moby/moby/pull/48141)
- containerd 集成：现在在使用 BuildKit 构建镜像时会正确触发 `image tag` 事件 [moby/moby#48182](https://github.com/moby/moby/pull/48182)
- CLI：为 `docker image rm`、`docker image history` 和 `docker image inspect` 启用了 shell 补全 [moby/moby#5261](https://github.com/moby/moby/pull/5261)
- CLI：为各种标志添加并改进了 shell 补全 [moby/moby#5261](https://github.com/moby/moby/pull/5261)
- CLI：在 `docker service create` 和 `docker stack` 中增加了 OOMScoreAdj 支持 [docker/cli#5274](https://github.com/docker/cli/pull/5274)
- CLI：增加了对 `DOCKER_CUSTOM_HEADERS` 环境变量的支持 (实验性) [docker/cli#5271](https://github.com/docker/cli/pull/5271)
- CLI：containerd 集成：修复了 `docker push` 在不支持的 API 版本上将 `--platform` 标志默认设置为 `DOCKER_DEFAULT_PLATFORM` 环境变量值的问题 [docker/cli#5248](https://github.com/docker/cli/pull/5248)
- CLI：修复：`login` 提示上的上下文取消问题 [docker/cli#5260](https://github.com/docker/cli/pull/5260)
- CLI：修复：在连接容器时向 CLI 发送终止请求时，在关闭流之前等待容器退出 [docker/cli#5250](https://github.com/docker/cli/pull/5250)

#### 弃用

- `pkg/rootless/specconv` 包已弃用，并将在下一个版本中移除 [moby/moby#48185](https://github.com/moby/moby/pull/48185)
- `pkg/containerfs` 包已弃用，并将在下一个版本中移除 [moby/moby#48185](https://github.com/moby/moby/pull/48185)
- `pkg/directory` 包已弃用，并将在下一个版本中移除 [moby/moby#48185](https://github.com/moby/moby/pull/48185)
- `api/types/system`：移除了已弃用的 `Info.ExecutionDriver` [moby/moby#48184](https://github.com/moby/moby/pull/48184)

#### 打包更新

- 将 Buildx 更新至 [v0.16.1](https://github.com/docker/buildx/releases/tag/v0.16.1)。[moby/docker-ce-packaging#1039](https://github.com/docker/docker-ce-packaging/pull/1039)
- 将 Compose 更新至 [v2.29.0](https://github.com/docker/compose/releases/tag/v2.29.0)。[moby/docker-ce-packaging#1038](https://github.com/docker/docker-ce-packaging/pull/1038)
- 将 containerd (仅限静态二进制文件) 更新至 [v1.7.20](https://github.com/containerd/containerd/releases/tag/v1.7.20)。[moby/moby#48191](https://github.com/moby/moby/pull/48191)
- 将 BuildKit 更新至 [v0.15.0](https://github.com/moby/buildkit/releases/tag/v0.15.0)。[moby/moby#48175](https://github.com/moby/moby/pull/48175)
- 将 Go 运行时更新至 1.21.12，包含对 [CVE-2024-24791](https://github.com/advisories/GHSA-hw49-2p59-3mhj) 的安全修复 [moby/moby#48120](https://github.com/moby/moby/pull/48120)

## 27.0

Docker Engine 27.0 发布说明。

### 27.0.3

{{< release-date date="2024-07-01" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.0.3 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.0.3)
- [moby/moby, 27.0.3 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.0.3)
- 已弃用和已移除的功能，请参阅 [已弃用的功能](https://github.com/docker/cli/blob/v27.0.3/docs/deprecated.md)。
- Engine API 的变更，请参阅 [API 版本历史](https://github.com/moby/moby/blob/v27.0.3/docs/api/version-history.md)。

#### 错误修复与改进

- 修复了一个回归问题，该问题错误地将从主机 IPv6 地址到仅 IPv4 容器的端口映射报告为错误。[moby/moby#48090](https://github.com/moby/moby/pull/48090)
- 修复了一个回归问题，该问题导致在创建网络时出现重复的子网分配。[moby/moby#48089](https://github.com/moby/moby/pull/48089)
- 修复了一个回归问题，该问题在支持具有用户命名空间的原生 overlay 的系统上尝试拉取启用了 rootless 的镜像时，导致 `fail to register layer: failed to Lchown` 错误。[moby/moby#48086](https://github.com/moby/moby/pull/48086)

### 27.0.2

{{< release-date date="2024-06-27" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.0.2 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.0.2)
- [moby/moby, 27.0.2 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.0.2)
- 已弃用和已移除的功能，请参阅 [已弃用的功能](https://github.com/docker/cli/blob/v27.0.2/docs/deprecated.md)。
- Engine API 的变更，请参阅 [API 版本历史](https://github.com/moby/moby/blob/v27.0.2/docs/api/version-history.md)。

#### 错误修复与改进

- 修复了一个回归问题，该问题导致在解析 Docker 注册表 URL 时端口号被忽略。[docker/cli#5197](https://github.com/docker/cli/pull/5197), [docker/cli#5198](https://github.com/docker/cli/pull/5198)

#### 已移除

- api/types：弃用 `ContainerJSONBase.Node` 字段和 `ContainerNode` 类型。这些定义由独立运行的 (“经典”) Swarm API 使用，但从未在 Docker Engine 本身中实现。[moby/moby#48055](https://github.com/moby/moby/pull/48055)


### 27.0.1

{{< release-date date="2024-06-24" >}}

有关此版本中拉取请求 (PR) 和变更的完整列表，请参考相关的 GitHub 里程碑：

- [docker/cli, 27.0.0 里程碑](https://github.com/docker/cli/issues?q=is%3Aclosed+milestone%3A27.0.0)
- [moby/moby, 27.0.0 里程碑](https://github.com/moby/moby/issues?q=is%3Aclosed+milestone%3A27.0.0)
- 已弃用和已移除的功能，请参阅 [已弃用的功能](https://github.com/docker/cli/blob/v27.0.1/docs/deprecated.md)。
- Engine API 的变更，请参阅 [API 版本历史](https://github.com/moby/moby/blob/v27.0.1/docs/api/version-history.md)。

#### 新增功能

- containerd 镜像存储：为 `docker image push` 添加了 `--platform` 标志，并改进了在本地未提供多平台镜像的所有平台时的默认行为。[docker/cli#4984](https://github.com/docker/cli/pull/4984), [moby/moby#47679](https://github.com/moby/moby/pull/47679)
- 为 `docker stack deploy` 增加了对服务网络中 `driver_opts` 的支持。[docker/cli#5125](https://github.com/docker/cli/pull/5125)
- 在通过带有 `docker-` 前缀的名称查找用户空间代理二进制文件时，考虑额外的 `/usr/local/libexec` 和 `/usr/libexec` 路径。[moby/moby#47804](https://github.com/moby/moby/pull/47804)

#### 错误修复与改进

- `*client.Client` 实例现在对于多个 goroutine 的并发使用始终是安全的。此前，在使用 `WithAPIVersionNegotiation()` 选项时可能会导致数据竞争。[moby/moby#47961](https://github.com/moby/moby/pull/47961)
- 修复了导致 Docker CLI 在某些情况下在 `$TMPDIR` 中泄漏 Unix 套接字的 bug。[docker/cli#5146](https://github.com/docker/cli/pull/5146)
- 当与 `--privileged` 结合使用时，不再忽略自定义的 seccomp 配置文件。[moby/moby#47500](https://github.com/moby/moby/pull/47500)
- rootless：overlay2：在使用 Linux 内核版本 5.11 及更高版本的无根模式时，支持原生 overlay diff。[moby/moby#47605](https://github.com/moby/moby/pull/47605)
- 修复了健康检查的 `StartInterval` 默认值，以反映文档中的 5s 值。[moby/moby#47799](https://github.com/moby/moby/pull/47799)
- 修复了当操作被用户取消 (例如通过 <kbd>Ctrl+C</kbd>) 时，`docker save` 和 `docker load` 在守护进程端不结束的问题。[moby/moby#47629](https://github.com/moby/moby/pull/47629)
- 容器的 `StartedAt` 属性现在在容器启动前记录，保证 `StartedAt` 始终在 `FinishedAt` 之前。[moby/moby#47003](https://github.com/moby/moby/pull/47003)
- Windows 上 Windows 容器使用的内部 DNS 解析器现在默认转发请求到外部 DNS 服务器。这使得 `nslookup` 能够解析外部主机名。此行为可以通过 `daemon.json` 使用 `"features": { "windows-dns-proxy": false }` 来禁用。该配置选项将在未来的版本中移除。[moby/moby#47826](https://github.com/moby/moby/pull/47826)
- 当 CLI 没有读取配置文件的权限时打印警告。[docker/cli#5077](https://github.com/docker/cli/pull/5077)
- 修复了容器连接 (attach) 时的 goroutine 和文件描述符泄漏问题。[moby/moby#45052](https://github.com/moby/moby/pull/45052)
- 在守护进程启动期间清除所有停止或已死亡容器的网络状态。[moby/moby#47984](https://github.com/moby/moby/pull/47984)
- 原子地写入卷选项 JSON，以避免系统崩溃后出现 "invalid JSON" 错误。[moby/moby#48034](https://github.com/moby/moby/pull/48034)
- 允许具有相同父接口的多个 macvlan 网络。[moby/moby#47318](https://github.com/moby/moby/pull/47318)
- 允许在通告支持 BuildKit 的 Windows 守护进程上使用 BuildKit。[docker/cli#5178](https://github.com/docker/cli/pull/5178)

#### 联网

- 允许在容器创建和网络连接期间为每个接口设置 sysctls。[moby/moby#47686](https://github.com/moby/moby/pull/47686)
  * 在未来的版本中，这将是设置按接口 sysctl 选项的唯一方式。
    例如，在 `docker run` 命令的命令行中，`--network mynet --sysctl net.ipv4.conf.eth0.log_martians=1` 将被拒绝。
    相反，您必须使用 `--network name=mynet,driver-opt=com.docker.network.endpoint.sysctls=net.ipv4.conf.IFNAME.log_martians=1`。

##### IPv6

- `ip6tables` 不再是实验性功能。如果其他功能不需要，您可以移除 `experimental` 配置选项并继续使用 IPv6。
- `ip6tables` 现在对 Linux 桥接网络默认启用。[moby/moby#47747](https://github.com/moby/moby/pull/47747)
  - 这使得 IPv4 和 IPv6 行为保持一致，并降低了启用了 IPv6 的容器被无意中暴露给网络的风险。
  - 如果您在运行 Docker Engine 时已启用了 `ip6tables` (新默认值)，则没有影响。
  - 如果您正在使用未启用 `ip6tables` 的支持 IPv6 的桥接网络，这可能是一个破坏性变更。只有已发布的容器端口 (`-p` 或 `--publish`) 可以从 Docker 桥接网络外部访问，且传出连接将伪装为主机。
  - 要恢复早期版本的行为 (完全没有 `ip6tables`)，请在 `daemon.json` 中设置 `"ip6tables": false`，或使用 CLI 选项 `--ip6tables=false`。或者，保持 `ip6tables` 启用，发布端口，并启用直接路由。
  - 在启用 `ip6tables` 的情况下，如果您的主机上 `ip6tables` 无法工作，Docker Engine 将启动，但无法创建支持 IPv6 的网络。

##### IPv6 网络配置改进

- 如果未手动配置 `default-address-pools` 参数，或其不包含 IPv6 前缀，则会自动向其添加唯一本地地址 (ULA) 基础前缀。[moby/moby#47853](https://github.com/moby/moby/pull/47853)
  - 在此版本之前，要创建支持 IPv6 的网络，必须使用 `--subnet` 选项指定 IPv6 子网，或在 `daemon.json` 的 `default-address-pools` 中添加 IPv6 范围。
  - 从此版本开始，当使用 `--ipv6` 创建桥接网络且这些选项未定义 IPv6 子网时，将使用 IPv6 唯一本地地址 (ULA) 基础前缀。
  - ULA 前缀派生自 Engine 主机 ID，因此它跨主机且随时间是唯一的。
- 任何大小的 IPv6 地址池现在都可以添加到 `default-address-pools` 中。[moby/moby#47768](https://github.com/moby/moby/pull/47768)
- 现在可以通过在 `daemon.json` 中使用 `"default-network-opts": { "bridge": {"com.docker.network.enable_ipv6": "true"}}`，或在命令行使用 `dockerd --default-network-opt=bridge=com.docker.network.enable_ipv6=true`，在所有自定义桥接网络上默认启用 IPv6。[moby/moby#47867](https://github.com/moby/moby/pull/47867)
- 启用 `ip6tables` 的 IPv6 网络直接路由。[moby/moby#47871](https://github.com/moby/moby/pull/47871)
  - 增加了桥接驱动程序选项 `com.docker.network.bridge.gateway_mode_ipv6=<nat|routed>`。
  - 默认行为 `nat` 与启用 `ip6tables` 的之前版本相比保持不变。为每个发布的容器端口设置了 NAT 和伪装规则。
  - 当设置为 `routed` 时，不会为已发布端口配置 NAT 或伪装规则。如果主机的网络可以将容器地址的数据包路由到主机，这将实现对容器的直接 IPv6 访问。发布的端口将在容器的防火墙中打开。
  - 当端口映射仅适用于 `routed` 模式时，仅允许地址 `0.0.0.0` 或 `::`，且不得给出主机端口。
  - 请注意，在 `nat` 或 `routed` 模式下，已发布的容器端口可从任何远程地址访问 (如果在网络中设置了路由)，除非 Docker 主机的防火墙有额外限制。例如：`docker network create --ipv6 -o com.docker.network.bridge.gateway_mode_ipv6=routed mynet`。
  - 选项 `com.docker.network.bridge.gateway_mode_ipv4=<nat|routed>` 也可用，行为相同，但针对 IPv4。
- 如果主机上运行着 firewalld，Docker 会创建 `docker-forwarding` 策略，以允许从任何区域转发到 `docker` 区域。这使得配置具有可路由 IPv6 地址且无 NAT 或伪装的桥接网络成为可能。[moby/moby#47745](https://github.com/moby/moby/pull/47745)
- 当发布端口未指定主机端口，或给出了主机端口范围时，IPv4 和 IPv6 将分配相同的端口。[moby/moby#47871](https://github.com/moby/moby/pull/47871)
  - 例如，`-p 80` 将导致为 `0.0.0.0` 和 `::` 分配相同的临时端口，而 `-p 8080-8083:80` 将从范围中为两个地址族选取相同的端口。
  - 类似地，发布到特定地址的端口也将分配相同的端口。例如，`-p 127.0.0.1::80 -p '[::1]::80'`。
  - 如果没有任何端口在所有要求地址上都可用，容器创建将失败。
- 在 26.1.1 版本中引入的环境变量 `DOCKER_ALLOW_IPV6_ON_IPV4_INTERFACE` 不再起作用。[moby/moby#47963](https://github.com/moby/moby/pull/47963)
  - 如果由于 `/proc/sys/net` 只读而无法在接口上禁用 IPv6，该环境变量曾允许容器仍然启动。
  - 在此版本中，如果无法为接口禁用 IPv4，只需在创建网络时使用 `--ipv6` 即可显式启用 IPv6。其他变通方法包括配置操作系统默认在各新接口上禁用 IPv6、以读写方式挂载 `/proc/sys/net` 或使用不支持 IPv6 的内核。
- 对于支持 IPv6 的桥接网络，不再尝试将内核分配给网桥的链路本地地址替换为 `fe80::1`。[moby/moby#47787](https://github.com/moby/moby/pull/47787)

#### 已移除

- 弃用实验性的 GraphDriver 插件。[moby/moby#48050](https://github.com/moby/moby/pull/48050), [docker/cli#5172](https://github.com/docker/cli/pull/5172)
- pkg/archive：弃用 `NewTempArchive` 和 `TempArchive`。这些类型仅在测试中使用，并将从下一个版本中移除。[moby/moby#48002](https://github.com/moby/moby/pull/48002)
- pkg/archive：弃用 `CanonicalTarNameForPath` [moby/moby#48001](https://github.com/moby/moby/pull/48001)
- 弃用 pkg/dmesg。该包已不再使用，并将在下一个版本中移除。[moby/moby#47999](https://github.com/moby/moby/pull/47999)
- 弃用 `pkg/stringid.ValidateID` 和 `pkg/stringid.IsShortID` [moby/moby#47995](https://github.com/moby/moby/pull/47995)
- runconfig：弃用 `SetDefaultNetModeIfBlank` 并将 `ContainerConfigWrapper` 移至 `api/types/container` [moby/moby#48007](https://github.com/moby/moby/pull/48007)
- runconfig：弃用 `DefaultDaemonNetworkMode` 并移至 `daemon/network` [moby/moby#48008](https://github.com/moby/moby/pull/48008)
- runconfig：弃用 `opts.ConvertKVStringsToMap`。此工具已不再使用，并将在下一个版本中移除。[moby/moby#48016](https://github.com/moby/moby/pull/48016)
- runconfig：弃用 `IsPreDefinedNetwork`。[moby/moby#48011](https://github.com/moby/moby/pull/48011)

#### API

- containerd 镜像存储：`POST /images/{name}/push` 现在支持 `platform` 参数 (JSON 编码的 OCI Platform 类型)，允许从多平台镜像中选择特定的平台清单。这是实验性的，可能会在未来的 API 版本中更改。[moby/moby#47679](https://github.com/moby/moby/pull/47679)
- `POST /services/create` 和 `POST /services/{id}/update` 现在支持 `OomScoreAdj`。[moby/moby#47950](https://github.com/moby/moby/pull/47950)
- `ContainerList` API 返回容器注释 (annotations)。[moby/moby#47866](https://github.com/moby/moby/pull/47866)
- `POST /containers/create` 和 `POST /services/create` 现在接受 `Options` 作为 `HostConfig.Mounts.TmpfsOptions` 的一部分，允许为 tmpfs 挂载设置选项。[moby/moby#46809](https://github.com/moby/moby/pull/46809)
- 使用低于 v1.44 的 API 版本更新 Swarm 服务时，现在会正确忽略 `Healthcheck.StartInterval` 属性。[moby/moby#47991](https://github.com/moby/moby/pull/47991)
- `GET /events` 现在支持镜像的 `create` 事件，该事件在构建新镜像时触发，无论该镜像是否被打上标签。[moby/moby#47929](https://github.com/moby/moby/pull/47929)
- `GET /info` 现在包含 `Containerd` 字段，包含有关守护进程用于运行容器和插件的 containerd API 套接字位置和 containerd 命名空间的信息。[moby/moby#47239](https://github.com/moby/moby/pull/47239)
- 弃用镜像 inspect 输出中的非标准 (配置) 字段。该端点 (用于 `docker image inspect`) 返回的 `Config` 字段包含了不属于镜像配置、不属于 [Docker 镜像规范] 和 [OCI 镜像规范] 的额外字段。这些字段从未被设置 (且始终返回该类型的默认值)，但在留空时不会在响应中被省略。由于这些字段并非镜像配置响应的组成部分，因此被弃用，并将从未来的 API 版本中移除。
- 弃用守护进程标志 `--api-cors-header` 及对应的 `daemon.json` 配置选项。它们将从下一个大版本中移除。[moby/moby#45313](https://github.com/moby/moby/pull/45313)

以下已弃用的字段目前包含在 API 响应中，但不属于底层镜像的 `Config`：[moby/moby#47941](https://github.com/moby/moby/pull/47941)

- `Hostname`
- `Domainname`
- `AttachStdin`
- `AttachStdout`
- `AttachStderr`
- `Tty`
- `OpenStdin`
- `StdinOnce`
- `Image`
- `NetworkDisabled` (除非设置，否则已省略)
- `MacAddress` (除非设置，否则已省略)
- `StopTimeout` (除非设置，否则已省略)

#### Go SDK 变更

- 以下函数的客户端 API 回调现在需要一个 context 参数。[moby/moby#47536](https://github.com/moby/moby/pull/47536)
  - `client.RequestPrivilegeFunc`
  - `client.ImageSearchOptions.AcceptPermissionsFunc`
  - `image.ImportOptions.PrivilegeFunc`
- 移除了镜像类型的已弃用别名。[moby/moby#47900](https://github.com/moby/moby/pull/47900)
  - `ImageImportOptions`
  - `ImageCreateOptions`
  - `ImagePullOptions`
  - `ImagePushOptions`
  - `ImageListOptions`
  - `ImageRemoveOptions`
- 引入了 `Ulimit` 类型作为 `github.com/docker/go-units.Ulimit` 的别名。
  API 中使用的 `Ulimit` 类型定义在一个未来将迁移到新位置的 Go 模块中。
  增加类型别名是为了减少迁移该类型带来的摩擦。
  该别名确保现有代码继续工作，但其定义将来可能会更改。
  建议用户使用此别名，而不是直接使用 `units.Ulimit`。[moby/moby#48023](https://github.com/moby/moby/pull/48023)

移动并重命名了类型，更改了它们的导入路径和导出的名称。
[moby/moby#47936](https://github.com/moby/moby/pull/47936),
[moby/moby#47873](https://github.com/moby/moby/pull/47873),
[moby/moby#47887](https://github.com/moby/moby/pull/47887),
[moby/moby#47882](https://github.com/moby/moby/pull/47882),
[moby/moby#47921](https://github.com/moby/moby/pull/47921),
[moby/moby#48040](https://github.com/moby/moby/pull/48040)

- 将以下类型移至 `api/types/container`：
  - `BlkioStatEntry`
  - `BlkioStats`
  - `CPUStats`
  - `CPUUsage`
  - `ContainerExecInspect`
  - `ContainerPathStat`
  - `ContainerStats`
  - `ContainersPruneReport`
  - `CopyToContainerOptions`
  - `ExecConfig`
  - `ExecStartCheck`
  - `MemoryStats`
  - `NetworkStats`
  - `PidsStats`
  - `StatsJSON`
  - `Stats`
  - `StorageStats`
  - `ThrottlingData`
- 将以下类型移至 `api/types/image`：
  - `ImagesPruneReport`
  - `ImageImportSource`
  - `ImageLoadResponse`
- 将 `ExecStartOptions` 类型移至 `api/types/backend`。
- 将 `VolumesPruneReport` 类型移至 `api/types/volume`。
- 将 `EventsOptions` 类型移至 `api/types/events`。
- 将 `ImageSearchOptions` 类型移至 `api/types/registry`。 
- 去除 `Network` 前缀并将以下类型移至 `api/types/network`：
  - `NetworkCreateResponse`
  - `NetworkConnect`
  - `NetworkDisconnect`
  - `NetworkInspectOptions`
  - `EndpointResource`
  - `NetworkListOptions`
  - `NetworkCreateOptions`
  - `NetworkCreateRequest`
  - `NetworksPruneReport`
- 将 `NetworkResource` 移至 `api/types/network`。

#### 打包更新

- 将 Buildx 更新至 [v0.15.1](https://github.com/docker/buildx/releases/tag/v0.15.1)。[docker/docker-ce-packaging#1029](https://github.com/docker/docker-ce-packaging/pull/1029)
- 将 BuildKit 更新至 [v0.14.1](https://github.com/moby/buildkit/releases/tag/v0.14.1)。[moby/moby#48028](https://github.com/moby/moby/pull/48028)
- 将 runc 更新至 [v1.1.13](https://github.com/opencontainers/runc/releases/tag/v1.1.13) [moby/moby#47976](https://github.com/moby/moby/pull/47976)
- 将 Compose 更新至 [v2.28.1](https://github.com/docker/compose/releases/tag/v2.28.1)。[moby/docker-ce-packaging#1032](https://github.com/docker/docker-ce-packaging/pull/1032)

[Docker 镜像规范]: https://github.com/moby/docker-image-spec/blob/v1.3.1/specs-go/v1/image.go#L19-L32
[OCI 镜像规范]: https://github.com/opencontainers/image-spec/blob/v1.1.0/specs-go/v1/config.go#L24-L62

### 27.0.0

由于在 GitHub 上发布 27.0.0-rc.1 预览版时的失误，导致创建了 v27.0.0 标签，因此没有 27.0.0 版本。
遗憾的是，该标签已被 [Go 模块镜像](https://sum.golang.org) 抓取，因此无法干净地更改 v27.0.0。
为解决此问题，27.0.1 将是 27.0 系列的第一个发布版本。
